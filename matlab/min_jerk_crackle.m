%% Symbolic spline, minimum-jerk, and minimum-crackle trajectory computation %%
% author: Giorgio Simonini
% date: 15/11/2022
% info: for efficiency reasons, best to substitute numerical values before
%       the symbolic computation (b, ti, tf)

%% Spline n-order generator
% ----- To Do ----- 

%% Minimum jerk (continuous acceleration)
syms q_i q_f dq_i dq_f ddq_i ddq_f real			% configuration variables
syms t ti tf real								% times
syms a0 a1 a2 a3 a4 a5 real                     % coeffiients

b = [q_i; dq_i; ddq_i; q_f; dq_f; ddq_f];		% initial-final conditions

a = [a0 a1 a2 a3 a4 a5];						% coefficients vector
T = [1; t; t^2; t^3; t^4; t^5];					% time vector

% differentiation
x = a*T;
dx = diff(x,t);
dx = simplify(dx);
ddx = diff(dx,t);
ddx = simplify(ddx);

% general initial constraints
x_i = subs(x, t, ti);
dx_i = subs(dx, t, ti);
ddx_i = subs(ddx, t, ti);

% general final constraints
x_f = subs(x, t, tf);
dx_f = subs(dx, t, tf);
ddx_f = subs(ddx, t, tf);

% coefficients calculation
f = [x_i; dx_i; ddx_i; x_f; dx_f; ddx_f];
A = jacobian(f, a);
coeffs = A\b;

% trajectory
q_des = coeffs'*T;
min_j.q_des = simplify(q_des);
dq_des = diff(q_des, t);
min_j.dq_des = simplify(dq_des);
ddq_des = diff(dq_des, t);
min_j.ddq_des = simplify(ddq_des);

disp('minimum-jerk done!')

%% ----- Computed ----- %%
% q_des = (0.5000*(12*q_f*t^5 - 12*q_i*t^5 + 2*q_i*tf^5 - 2*q_f*ti^5 - 6*dq_f*t^5*tf + 2*dq_i*t*tf^5 - 6*dq_i*t^5*tf - 2*dq_f*t*ti^5 + 6*dq_f*t^5*ti + 6*dq_i*t^5*ti + 2*dq_f*tf*ti^5 - 2*dq_i*tf^5*ti - 30*q_f*t^4*tf + 30*q_i*t^4*tf - 30*q_f*t^4*ti + 30*q_i*t^4*ti + 10*q_f*tf*ti^4 - 10*q_i*tf^4*ti + ddq_f*t^3*tf^4 - 2*ddq_f*t^4*tf^3 + ddq_f*t^5*tf^2 + ddq_i*t^2*tf^5 - 3*ddq_i*t^3*tf^4 + 3*ddq_i*t^4*tf^3 - ddq_i*t^5*tf^2 - ddq_f*t^2*ti^5 + 3*ddq_f*t^3*ti^4 - 3*ddq_f*t^4*ti^3 + ddq_f*t^5*ti^2 - ddq_i*t^3*ti^4 + 2*ddq_i*t^4*ti^3 - ddq_i*t^5*ti^2 - 8*dq_f*t^3*tf^3 + 14*dq_f*t^4*tf^2 - 12*dq_i*t^3*tf^3 + 16*dq_i*t^4*tf^2 + 12*dq_f*t^3*ti^3 - 16*dq_f*t^4*ti^2 + 8*dq_i*t^3*ti^3 - 14*dq_i*t^4*ti^2 - ddq_f*tf^2*ti^5 + 2*ddq_f*tf^3*ti^4 - ddq_f*tf^4*ti^3 + ddq_i*tf^3*ti^4 - 2*ddq_i*tf^4*ti^3 + ddq_i*tf^5*ti^2 - 10*dq_f*tf^2*ti^4 + 8*dq_f*tf^3*ti^3 - 8*dq_i*tf^3*ti^3 + 10*dq_i*tf^4*ti^2 + 20*q_f*t^3*tf^2 - 20*q_i*t^3*tf^2 + 20*q_f*t^3*ti^2 - 20*q_i*t^3*ti^2 - 20*q_f*tf^2*ti^3 + 20*q_i*tf^3*ti^2 + 8*ddq_f*t^2*tf^2*ti^3 - 8*ddq_f*t^3*tf^2*ti^2 - 8*ddq_i*t^2*tf^3*ti^2 + 8*ddq_i*t^3*tf^2*ti^2 + 12*dq_f*t^2*tf^2*ti^2 - 12*dq_i*t^2*tf^2*ti^2 + 2*ddq_f*t*tf*ti^5 - 2*ddq_f*t^5*tf*ti - 2*ddq_i*t*tf^5*ti + 2*ddq_i*t^5*tf*ti + 10*dq_f*t*tf*ti^4 + 2*dq_f*t^4*tf*ti - 10*dq_i*t*tf^4*ti - 2*dq_i*t^4*tf*ti + 80*q_f*t^3*tf*ti - 80*q_i*t^3*tf*ti - ddq_f*t*tf^2*ti^4 - 4*ddq_f*t*tf^3*ti^3 + 3*ddq_f*t*tf^4*ti^2 - 4*ddq_f*t^2*tf*ti^4 - 3*ddq_f*t^2*tf^4*ti + 4*ddq_f*t^3*tf^3*ti + 4*ddq_f*t^4*tf*ti^2 + ddq_f*t^4*tf^2*ti - 3*ddq_i*t*tf^2*ti^4 + 4*ddq_i*t*tf^3*ti^3 + ddq_i*t*tf^4*ti^2 + 3*ddq_i*t^2*tf*ti^4 + 4*ddq_i*t^2*tf^4*ti - 4*ddq_i*t^3*tf*ti^3 - ddq_i*t^4*tf*ti^2 - 4*ddq_i*t^4*tf^2*ti + 16*dq_f*t*tf^2*ti^3 - 24*dq_f*t*tf^3*ti^2 - 36*dq_f*t^2*tf*ti^3 + 24*dq_f*t^2*tf^3*ti + 28*dq_f*t^3*tf*ti^2 - 32*dq_f*t^3*tf^2*ti + 24*dq_i*t*tf^2*ti^3 - 16*dq_i*t*tf^3*ti^2 - 24*dq_i*t^2*tf*ti^3 + 36*dq_i*t^2*tf^3*ti + 32*dq_i*t^3*tf*ti^2 - 28*dq_i*t^3*tf^2*ti + 60*q_f*t*tf^2*ti^2 - 60*q_f*t^2*tf*ti^2 - 60*q_f*t^2*tf^2*ti - 60*q_i*t*tf^2*ti^2 + 60*q_i*t^2*tf*ti^2 + 60*q_i*t^2*tf^2*ti))/(tf - ti)^5;
% dq_des = (0.5000*(2*dq_i*tf^5 - 2*dq_f*ti^5 + 60*q_f*t^4 - 60*q_i*t^4 + 2*ddq_i*t*tf^5 - 2*ddq_f*t*ti^5 - 30*dq_f*t^4*tf - 30*dq_i*t^4*tf + 30*dq_f*t^4*ti + 30*dq_i*t^4*ti + 2*ddq_f*tf*ti^5 - 2*ddq_i*tf^5*ti + 10*dq_f*tf*ti^4 - 10*dq_i*tf^4*ti - 120*q_f*t^3*tf + 120*q_i*t^3*tf - 120*q_f*t^3*ti + 120*q_i*t^3*ti + 3*ddq_f*t^2*tf^4 - 8*ddq_f*t^3*tf^3 + 5*ddq_f*t^4*tf^2 - 9*ddq_i*t^2*tf^4 + 12*ddq_i*t^3*tf^3 - 5*ddq_i*t^4*tf^2 + 9*ddq_f*t^2*ti^4 - 12*ddq_f*t^3*ti^3 + 5*ddq_f*t^4*ti^2 - 3*ddq_i*t^2*ti^4 + 8*ddq_i*t^3*ti^3 - 5*ddq_i*t^4*ti^2 - 24*dq_f*t^2*tf^3 + 56*dq_f*t^3*tf^2 - 36*dq_i*t^2*tf^3 + 64*dq_i*t^3*tf^2 + 36*dq_f*t^2*ti^3 - 64*dq_f*t^3*ti^2 + 24*dq_i*t^2*ti^3 - 56*dq_i*t^3*ti^2 - ddq_f*tf^2*ti^4 - 4*ddq_f*tf^3*ti^3 + 3*ddq_f*tf^4*ti^2 - 3*ddq_i*tf^2*ti^4 + 4*ddq_i*tf^3*ti^3 + ddq_i*tf^4*ti^2 + 16*dq_f*tf^2*ti^3 - 24*dq_f*tf^3*ti^2 + 24*dq_i*tf^2*ti^3 - 16*dq_i*tf^3*ti^2 + 60*q_f*t^2*tf^2 - 60*q_i*t^2*tf^2 + 60*q_f*t^2*ti^2 - 60*q_i*t^2*ti^2 + 60*q_f*tf^2*ti^2 - 60*q_i*tf^2*ti^2 - 24*ddq_f*t^2*tf^2*ti^2 + 24*ddq_i*t^2*tf^2*ti^2 - 8*ddq_f*t*tf*ti^4 - 6*ddq_f*t*tf^4*ti - 10*ddq_f*t^4*tf*ti + 6*ddq_i*t*tf*ti^4 + 8*ddq_i*t*tf^4*ti + 10*ddq_i*t^4*tf*ti - 72*dq_f*t*tf*ti^3 + 48*dq_f*t*tf^3*ti + 8*dq_f*t^3*tf*ti - 48*dq_i*t*tf*ti^3 + 72*dq_i*t*tf^3*ti - 8*dq_i*t^3*tf*ti - 120*q_f*t*tf*ti^2 - 120*q_f*t*tf^2*ti + 240*q_f*t^2*tf*ti + 120*q_i*t*tf*ti^2 + 120*q_i*t*tf^2*ti - 240*q_i*t^2*tf*ti + 16*ddq_f*t*tf^2*ti^3 + 12*ddq_f*t^2*tf^3*ti + 16*ddq_f*t^3*tf*ti^2 + 4*ddq_f*t^3*tf^2*ti - 16*ddq_i*t*tf^3*ti^2 - 12*ddq_i*t^2*tf*ti^3 - 4*ddq_i*t^3*tf*ti^2 - 16*ddq_i*t^3*tf^2*ti + 24*dq_f*t*tf^2*ti^2 + 84*dq_f*t^2*tf*ti^2 - 96*dq_f*t^2*tf^2*ti - 24*dq_i*t*tf^2*ti^2 + 96*dq_i*t^2*tf*ti^2 - 84*dq_i*t^2*tf^2*ti))/(tf - ti)^5;
% ddq_des = (ddq_i*tf^5 - ddq_f*ti^5 + 120*q_f*t^3 - 120*q_i*t^3 + 3*ddq_f*t*tf^4 - 9*ddq_i*t*tf^4 + 9*ddq_f*t*ti^4 - 3*ddq_i*t*ti^4 - 24*dq_f*t*tf^3 - 60*dq_f*t^3*tf - 36*dq_i*t*tf^3 - 60*dq_i*t^3*tf + 36*dq_f*t*ti^3 + 60*dq_f*t^3*ti + 24*dq_i*t*ti^3 + 60*dq_i*t^3*ti - 4*ddq_f*tf*ti^4 - 3*ddq_f*tf^4*ti + 3*ddq_i*tf*ti^4 + 4*ddq_i*tf^4*ti - 36*dq_f*tf*ti^3 + 24*dq_f*tf^3*ti - 24*dq_i*tf*ti^3 + 36*dq_i*tf^3*ti + 60*q_f*t*tf^2 - 180*q_f*t^2*tf - 60*q_i*t*tf^2 + 180*q_i*t^2*tf + 60*q_f*t*ti^2 - 180*q_f*t^2*ti - 60*q_i*t*ti^2 + 180*q_i*t^2*ti - 60*q_f*tf*ti^2 - 60*q_f*tf^2*ti + 60*q_i*tf*ti^2 + 60*q_i*tf^2*ti - 12*ddq_f*t^2*tf^3 + 10*ddq_f*t^3*tf^2 + 18*ddq_i*t^2*tf^3 - 10*ddq_i*t^3*tf^2 - 18*ddq_f*t^2*ti^3 + 10*ddq_f*t^3*ti^2 + 12*ddq_i*t^2*ti^3 - 10*ddq_i*t^3*ti^2 + 84*dq_f*t^2*tf^2 + 96*dq_i*t^2*tf^2 - 96*dq_f*t^2*ti^2 - 84*dq_i*t^2*ti^2 + 8*ddq_f*tf^2*ti^3 - 8*ddq_i*tf^3*ti^2 + 12*dq_f*tf^2*ti^2 - 12*dq_i*tf^2*ti^2 + 240*q_f*t*tf*ti - 240*q_i*t*tf*ti + 12*ddq_f*t*tf^3*ti - 20*ddq_f*t^3*tf*ti - 12*ddq_i*t*tf*ti^3 + 20*ddq_i*t^3*tf*ti + 84*dq_f*t*tf*ti^2 - 96*dq_f*t*tf^2*ti + 12*dq_f*t^2*tf*ti + 96*dq_i*t*tf*ti^2 - 84*dq_i*t*tf^2*ti - 12*dq_i*t^2*tf*ti - 24*ddq_f*t*tf^2*ti^2 + 24*ddq_f*t^2*tf*ti^2 + 6*ddq_f*t^2*tf^2*ti + 24*ddq_i*t*tf^2*ti^2 - 6*ddq_i*t^2*tf*ti^2 - 24*ddq_i*t^2*tf^2*ti)/(tf - ti)^5;
 

%% ----- Minimum crackle (continuous jerk_dot) ----- %%
syms q_i q_f dq_i dq_f ddq_i ddq_f d3q_i d3q_f d4q_i d4q_f real         % configuration variables
syms t ti tf real                                                       % times
syms a0 a1 a2 a3 a4 a5 a6 a7 a8 a9 real                                 % coefficients

b = [q_i; dq_i; ddq_i; d3q_i; d4q_i; q_f; dq_f; ddq_f; d3q_f; d4q_f];   % initial-final conditions

a = [a0 a1 a2 a3 a4 a5 a6 a7 a8 a9];                                    % coefficients vector
T = [1; t; t^2; t^3; t^4; t^5; t^6; t^7; t^8; t^9];                     % time vector

% differentiation
x = a*T;
dx = diff(x,t);
dx = simplify(dx);
ddx = diff(dx,t);
ddx = simplify(ddx);
d3x = diff(ddx,t);
d3x = simplify(d3x);
d4x = diff(d3x,t);
d4x = simplify(d4x);

% initial constraints
x_i = subs(x, t, ti);
dx_i = subs(dx, t, ti);
ddx_i = subs(ddx, t, ti);
d3x_i = subs(d3x, t, ti);
d4x_i = subs(d4x, t, ti);

% final constraints
x_f = subs(x, t, tf);
dx_f = subs(dx, t, tf);
ddx_f = subs(ddx, t, tf);
d3x_f = subs(d3x, t, tf);
d4x_f = subs(d4x, t, tf);

% coefficients calculation
f = [x_i; dx_i; ddx_i; d3x_i; d4x_i; x_f; dx_f; ddx_f; d3x_f; d4x_f];
A = jacobian(f, a);
coeffs = A\b;

% trajectory
q_des = coeffs'*T;
min_c.q_des = simplify(q_des);
dq_des = diff(q_des, t);
min_c.dq_des = simplify(dq_des);
ddq_des = diff(dq_des, t);
min_c.ddq_des = simplify(ddq_des);
d3q_des = diff(ddq_des, t);
min_c.d3q_des = simplify(d3q_des);
d4q_des = diff(d3q_des, t);
min_c.d4q_des = simplify(d4q_des);

disp('minimum-crackle done!')

%% ----- Computed ----- %%
% q_des = (0.0417*(1680*q_f*t^9 - 1680*q_i*t^9 + 24*q_i*tf^9 - 24*q_f*ti^9 - 840*dq_f*t^9*tf + 24*dq_i*t*tf^9 - 840*dq_i*t^9*tf - 24*dq_f*t*ti^9 + 840*dq_f*t^9*ti + 840*dq_i*t^9*ti + 24*dq_f*tf*ti^9 - 24*dq_i*tf^9*ti - 7560*q_f*t^8*tf + 7560*q_i*t^8*tf - 7560*q_f*t^8*ti + 7560*q_i*t^8*ti + 216*q_f*tf*ti^8 - 216*q_i*tf^8*ti - 24*d3q_f*t^5*tf^7 + 92*d3q_f*t^6*tf^6 - 132*d3q_f*t^7*tf^5 + 84*d3q_f*t^8*tf^4 - 20*d3q_f*t^9*tf^3 + d4q_f*t^5*tf^8 - 4*d4q_f*t^6*tf^7 + 6*d4q_f*t^7*tf^6 - 4*d4q_f*t^8*tf^5 + d4q_f*t^9*tf^4 + 4*d3q_i*t^3*tf^9 - 60*d3q_i*t^5*tf^7 + 160*d3q_i*t^6*tf^6 - 180*d3q_i*t^7*tf^5 + 96*d3q_i*t^8*tf^4 - 20*d3q_i*t^9*tf^3 + d4q_i*t^4*tf^9 - 5*d4q_i*t^5*tf^8 + 10*d4q_i*t^6*tf^7 - 10*d4q_i*t^7*tf^6 + 5*d4q_i*t^8*tf^5 - d4q_i*t^9*tf^4 - 4*d3q_f*t^3*ti^9 + 60*d3q_f*t^5*ti^7 - 160*d3q_f*t^6*ti^6 + 180*d3q_f*t^7*ti^5 - 96*d3q_f*t^8*ti^4 + 20*d3q_f*t^9*ti^3 - d4q_f*t^4*ti^9 + 5*d4q_f*t^5*ti^8 - 10*d4q_f*t^6*ti^7 + 10*d4q_f*t^7*ti^6 - 5*d4q_f*t^8*ti^5 + d4q_f*t^9*ti^4 + 24*d3q_i*t^5*ti^7 - 92*d3q_i*t^6*ti^6 + 132*d3q_i*t^7*ti^5 - 84*d3q_i*t^8*ti^4 + 20*d3q_i*t^9*ti^3 - d4q_i*t^5*ti^8 + 4*d4q_i*t^6*ti^7 - 6*d4q_i*t^7*ti^6 + 4*d4q_i*t^8*ti^5 - d4q_i*t^9*ti^4 + 252*ddq_f*t^5*tf^6 - 924*ddq_f*t^6*tf^5 + 1272*ddq_f*t^7*tf^4 - 780*ddq_f*t^8*tf^3 + 180*ddq_f*t^9*tf^2 + 12*ddq_i*t^2*tf^9 - 420*ddq_i*t^5*tf^6 + 1260*ddq_i*t^6*tf^5 - 1512*ddq_i*t^7*tf^4 + 840*ddq_i*t^8*tf^3 - 180*ddq_i*t^9*tf^2 - 12*ddq_f*t^2*ti^9 + 420*ddq_f*t^5*ti^6 - 1260*ddq_f*t^6*ti^5 + 1512*ddq_f*t^7*ti^4 - 840*ddq_f*t^8*ti^3 + 180*ddq_f*t^9*ti^2 - 252*ddq_i*t^5*ti^6 + 924*ddq_i*t^6*ti^5 - 1272*ddq_i*t^7*ti^4 + 780*ddq_i*t^8*ti^3 - 180*ddq_i*t^9*ti^2 + 4*d3q_f*tf^3*ti^9 - 36*d3q_f*tf^4*ti^8 + 84*d3q_f*tf^5*ti^7 - 76*d3q_f*tf^6*ti^6 + 24*d3q_f*tf^7*ti^5 - d4q_f*tf^4*ti^9 + 4*d4q_f*tf^5*ti^8 - 6*d4q_f*tf^6*ti^7 + 4*d4q_f*tf^7*ti^6 - d4q_f*tf^8*ti^5 - 24*d3q_i*tf^5*ti^7 + 76*d3q_i*tf^6*ti^6 - 84*d3q_i*tf^7*ti^5 + 36*d3q_i*tf^8*ti^4 - 4*d3q_i*tf^9*ti^3 + d4q_i*tf^5*ti^8 - 4*d4q_i*tf^6*ti^7 + 6*d4q_i*tf^7*ti^6 - 4*d4q_i*tf^8*ti^5 + d4q_i*tf^9*ti^4 - 1344*dq_f*t^5*tf^5 + 4704*dq_f*t^6*tf^4 - 6240*dq_f*t^7*tf^3 + 3720*dq_f*t^8*tf^2 - 1680*dq_i*t^5*tf^5 + 5376*dq_i*t^6*tf^4 - 6720*dq_i*t^7*tf^3 + 3840*dq_i*t^8*tf^2 + 1680*dq_f*t^5*ti^5 - 5376*dq_f*t^6*ti^4 + 6720*dq_f*t^7*ti^3 - 3840*dq_f*t^8*ti^2 + 1344*dq_i*t^5*ti^5 - 4704*dq_i*t^6*ti^4 + 6240*dq_i*t^7*ti^3 - 3720*dq_i*t^8*ti^2 - 12*ddq_f*tf^2*ti^9 + 108*ddq_f*tf^3*ti^8 - 432*ddq_f*tf^4*ti^7 + 588*ddq_f*tf^5*ti^6 - 252*ddq_f*tf^6*ti^5 + 252*ddq_i*tf^5*ti^6 - 588*ddq_i*tf^6*ti^5 + 432*ddq_i*tf^7*ti^4 - 108*ddq_i*tf^8*ti^3 + 12*ddq_i*tf^9*ti^2 - 216*dq_f*tf^2*ti^8 + 864*dq_f*tf^3*ti^7 - 2016*dq_f*tf^4*ti^6 + 1344*dq_f*tf^5*ti^5 - 1344*dq_i*tf^5*ti^5 + 2016*dq_i*tf^6*ti^4 - 864*dq_i*tf^7*ti^3 + 216*dq_i*tf^8*ti^2 + 3024*q_f*t^5*tf^4 - 10080*q_f*t^6*tf^3 + 12960*q_f*t^7*tf^2 - 3024*q_i*t^5*tf^4 + 10080*q_i*t^6*tf^3 - 12960*q_i*t^7*tf^2 + 3024*q_f*t^5*ti^4 - 10080*q_f*t^6*ti^3 + 12960*q_f*t^7*ti^2 - 3024*q_i*t^5*ti^4 + 10080*q_i*t^6*ti^3 - 12960*q_i*t^7*ti^2 - 864*q_f*tf^2*ti^7 + 2016*q_f*tf^3*ti^6 - 3024*q_f*tf^4*ti^5 + 3024*q_i*tf^5*ti^4 - 2016*q_i*tf^6*ti^3 + 864*q_i*tf^7*ti^2 - 108*d3q_f*t^2*tf^2*ti^8 - 168*d3q_f*t^2*tf^3*ti^7 + 792*d3q_f*t^2*tf^4*ti^6 - 468*d3q_f*t^2*tf^5*ti^5 - 300*d3q_f*t^2*tf^6*ti^4 + 240*d3q_f*t^2*tf^7*ti^3 + 456*d3q_f*t^3*tf^2*ti^7 - 664*d3q_f*t^3*tf^3*ti^6 - 804*d3q_f*t^3*tf^4*ti^5 + 1380*d3q_f*t^3*tf^5*ti^4 - 160*d3q_f*t^3*tf^6*ti^3 - 240*d3q_f*t^3*tf^7*ti^2 - 300*d3q_f*t^4*tf^2*ti^6 + 1800*d3q_f*t^4*tf^3*ti^5 - 720*d3q_f*t^4*tf^4*ti^4 - 1140*d3q_f*t^4*tf^5*ti^3 + 540*d3q_f*t^4*tf^6*ti^2 - 720*d3q_f*t^5*tf^2*ti^5 - 1224*d3q_f*t^5*tf^3*ti^4 + 1716*d3q_f*t^5*tf^4*ti^3 + 36*d3q_f*t^5*tf^5*ti^2 + 1212*d3q_f*t^6*tf^2*ti^4 - 328*d3q_f*t^6*tf^3*ti^3 - 888*d3q_f*t^6*tf^4*ti^2 - 552*d3q_f*t^7*tf^2*ti^3 + 648*d3q_f*t^7*tf^3*ti^2 - 36*d3q_f*t^8*tf^2*ti^2 - 6*d4q_f*t^2*tf^2*ti^9 + 4*d4q_f*t^2*tf^3*ti^8 + 34*d4q_f*t^2*tf^4*ti^7 - 56*d4q_f*t^2*tf^5*ti^6 + 14*d4q_f*t^2*tf^6*ti^5 + 20*d4q_f*t^2*tf^7*ti^4 - 10*d4q_f*t^2*tf^8*ti^3 + 14*d4q_f*t^3*tf^2*ti^8 - 56*d4q_f*t^3*tf^3*ti^7 + 14*d4q_f*t^3*tf^4*ti^6 + 84*d4q_f*t^3*tf^5*ti^5 - 70*d4q_f*t^3*tf^6*ti^4 + 10*d4q_f*t^3*tf^8*ti^2 + 14*d4q_f*t^4*tf^2*ti^7 + 84*d4q_f*t^4*tf^3*ti^6 - 126*d4q_f*t^4*tf^4*ti^5 + 70*d4q_f*t^4*tf^6*ti^3 - 20*d4q_f*t^4*tf^7*ti^2 - 70*d4q_f*t^5*tf^2*ti^6 + 126*d4q_f*t^5*tf^4*ti^4 - 84*d4q_f*t^5*tf^5*ti^3 - 14*d4q_f*t^5*tf^6*ti^2 + 70*d4q_f*t^6*tf^2*ti^5 - 84*d4q_f*t^6*tf^3*ti^4 - 14*d4q_f*t^6*tf^4*ti^3 + 56*d4q_f*t^6*tf^5*ti^2 - 14*d4q_f*t^7*tf^2*ti^4 + 56*d4q_f*t^7*tf^3*ti^3 - 34*d4q_f*t^7*tf^4*ti^2 - 14*d4q_f*t^8*tf^2*ti^3 - 4*d4q_f*t^8*tf^3*ti^2 + 6*d4q_f*t^9*tf^2*ti^2 - 240*d3q_i*t^2*tf^3*ti^7 + 300*d3q_i*t^2*tf^4*ti^6 + 468*d3q_i*t^2*tf^5*ti^5 - 792*d3q_i*t^2*tf^6*ti^4 + 168*d3q_i*t^2*tf^7*ti^3 + 108*d3q_i*t^2*tf^8*ti^2 + 240*d3q_i*t^3*tf^2*ti^7 + 160*d3q_i*t^3*tf^3*ti^6 - 1380*d3q_i*t^3*tf^4*ti^5 + 804*d3q_i*t^3*tf^5*ti^4 + 664*d3q_i*t^3*tf^6*ti^3 - 456*d3q_i*t^3*tf^7*ti^2 - 540*d3q_i*t^4*tf^2*ti^6 + 1140*d3q_i*t^4*tf^3*ti^5 + 720*d3q_i*t^4*tf^4*ti^4 - 1800*d3q_i*t^4*tf^5*ti^3 + 300*d3q_i*t^4*tf^6*ti^2 - 36*d3q_i*t^5*tf^2*ti^5 - 1716*d3q_i*t^5*tf^3*ti^4 + 1224*d3q_i*t^5*tf^4*ti^3 + 720*d3q_i*t^5*tf^5*ti^2 + 888*d3q_i*t^6*tf^2*ti^4 + 328*d3q_i*t^6*tf^3*ti^3 - 1212*d3q_i*t^6*tf^4*ti^2 - 648*d3q_i*t^7*tf^2*ti^3 + 552*d3q_i*t^7*tf^3*ti^2 + 36*d3q_i*t^8*tf^2*ti^2 + 10*d4q_i*t^2*tf^3*ti^8 - 20*d4q_i*t^2*tf^4*ti^7 - 14*d4q_i*t^2*tf^5*ti^6 + 56*d4q_i*t^2*tf^6*ti^5 - 34*d4q_i*t^2*tf^7*ti^4 - 4*d4q_i*t^2*tf^8*ti^3 + 6*d4q_i*t^2*tf^9*ti^2 - 10*d4q_i*t^3*tf^2*ti^8 + 70*d4q_i*t^3*tf^4*ti^6 - 84*d4q_i*t^3*tf^5*ti^5 - 14*d4q_i*t^3*tf^6*ti^4 + 56*d4q_i*t^3*tf^7*ti^3 - 14*d4q_i*t^3*tf^8*ti^2 + 20*d4q_i*t^4*tf^2*ti^7 - 70*d4q_i*t^4*tf^3*ti^6 + 126*d4q_i*t^4*tf^5*ti^4 - 84*d4q_i*t^4*tf^6*ti^3 - 14*d4q_i*t^4*tf^7*ti^2 + 14*d4q_i*t^5*tf^2*ti^6 + 84*d4q_i*t^5*tf^3*ti^5 - 126*d4q_i*t^5*tf^4*ti^4 + 70*d4q_i*t^5*tf^6*ti^2 - 56*d4q_i*t^6*tf^2*ti^5 + 14*d4q_i*t^6*tf^3*ti^4 + 84*d4q_i*t^6*tf^4*ti^3 - 70*d4q_i*t^6*tf^5*ti^2 + 34*d4q_i*t^7*tf^2*ti^4 - 56*d4q_i*t^7*tf^3*ti^3 + 14*d4q_i*t^7*tf^4*ti^2 + 4*d4q_i*t^8*tf^2*ti^3 + 14*d4q_i*t^8*tf^3*ti^2 - 6*d4q_i*t^9*tf^2*ti^2 - 432*ddq_f*t^2*tf^2*ti^7 - 3192*ddq_f*t^2*tf^3*ti^6 + 4788*ddq_f*t^2*tf^4*ti^5 + 1260*ddq_f*t^2*tf^5*ti^4 - 2520*ddq_f*t^2*tf^6*ti^3 + 4200*ddq_f*t^3*tf^2*ti^6 - 10080*ddq_f*t^3*tf^4*ti^4 + 3360*ddq_f*t^3*tf^5*ti^3 + 2520*ddq_f*t^3*tf^6*ti^2 - 6300*ddq_f*t^4*tf^2*ti^5 + 10080*ddq_f*t^4*tf^3*ti^4 + 5880*ddq_f*t^4*tf^4*ti^3 - 6300*ddq_f*t^4*tf^5*ti^2 + 252*ddq_f*t^5*tf^2*ti^4 - 12768*ddq_f*t^5*tf^3*ti^3 + 2772*ddq_f*t^5*tf^4*ti^2 + 6216*ddq_f*t^6*tf^2*ti^3 + 4536*ddq_f*t^6*tf^3*ti^2 - 4608*ddq_f*t^7*tf^2*ti^2 + 2520*ddq_i*t^2*tf^3*ti^6 - 1260*ddq_i*t^2*tf^4*ti^5 - 4788*ddq_i*t^2*tf^5*ti^4 + 3192*ddq_i*t^2*tf^6*ti^3 + 432*ddq_i*t^2*tf^7*ti^2 - 2520*ddq_i*t^3*tf^2*ti^6 - 3360*ddq_i*t^3*tf^3*ti^5 + 10080*ddq_i*t^3*tf^4*ti^4 - 4200*ddq_i*t^3*tf^6*ti^2 + 6300*ddq_i*t^4*tf^2*ti^5 - 5880*ddq_i*t^4*tf^3*ti^4 - 10080*ddq_i*t^4*tf^4*ti^3 + 6300*ddq_i*t^4*tf^5*ti^2 - 2772*ddq_i*t^5*tf^2*ti^4 + 12768*ddq_i*t^5*tf^3*ti^3 - 252*ddq_i*t^5*tf^4*ti^2 - 4536*ddq_i*t^6*tf^2*ti^3 - 6216*ddq_i*t^6*tf^3*ti^2 + 4608*ddq_i*t^7*tf^2*ti^2 - 16800*dq_f*t^2*tf^3*ti^5 + 3360*dq_f*t^2*tf^4*ti^4 + 13440*dq_f*t^2*tf^5*ti^3 + 16800*dq_f*t^3*tf^2*ti^5 + 23520*dq_f*t^3*tf^3*ti^4 - 26880*dq_f*t^3*tf^4*ti^3 - 13440*dq_f*t^3*tf^5*ti^2 - 38640*dq_f*t^4*tf^2*ti^4 + 3360*dq_f*t^4*tf^3*ti^3 + 36960*dq_f*t^4*tf^4*ti^2 + 28896*dq_f*t^5*tf^2*ti^3 - 31584*dq_f*t^5*tf^3*ti^2 + 1344*dq_f*t^6*tf^2*ti^2 - 13440*dq_i*t^2*tf^3*ti^5 - 3360*dq_i*t^2*tf^4*ti^4 + 16800*dq_i*t^2*tf^5*ti^3 + 13440*dq_i*t^3*tf^2*ti^5 + 26880*dq_i*t^3*tf^3*ti^4 - 23520*dq_i*t^3*tf^4*ti^3 - 16800*dq_i*t^3*tf^5*ti^2 - 36960*dq_i*t^4*tf^2*ti^4 - 3360*dq_i*t^4*tf^3*ti^3 + 38640*dq_i*t^4*tf^4*ti^2 + 31584*dq_i*t^5*tf^2*ti^3 - 28896*dq_i*t^5*tf^3*ti^2 - 1344*dq_i*t^6*tf^2*ti^2 - 30240*q_f*t^2*tf^3*ti^4 - 30240*q_f*t^2*tf^4*ti^3 + 30240*q_f*t^3*tf^2*ti^4 + 80640*q_f*t^3*tf^3*ti^3 + 30240*q_f*t^3*tf^4*ti^2 - 90720*q_f*t^4*tf^2*ti^3 - 90720*q_f*t^4*tf^3*ti^2 + 108864*q_f*t^5*tf^2*ti^2 + 30240*q_i*t^2*tf^3*ti^4 + 30240*q_i*t^2*tf^4*ti^3 - 30240*q_i*t^3*tf^2*ti^4 - 80640*q_i*t^3*tf^3*ti^3 - 30240*q_i*t^3*tf^4*ti^2 + 90720*q_i*t^4*tf^2*ti^3 + 90720*q_i*t^4*tf^3*ti^2 - 108864*q_i*t^5*tf^2*ti^2 + 24*ddq_f*t*tf*ti^9 - 360*ddq_f*t^9*tf*ti - 24*ddq_i*t*tf^9*ti + 360*ddq_i*t^9*tf*ti + 216*dq_f*t*tf*ti^8 + 120*dq_f*t^8*tf*ti - 216*dq_i*t*tf^8*ti - 120*dq_i*t^8*tf*ti + 34560*q_f*t^7*tf*ti - 34560*q_i*t^7*tf*ti - 12*d3q_f*t*tf^2*ti^9 + 108*d3q_f*t*tf^3*ti^8 - 132*d3q_f*t*tf^4*ti^7 - 132*d3q_f*t*tf^5*ti^6 + 288*d3q_f*t*tf^6*ti^5 - 120*d3q_f*t*tf^7*ti^4 + 12*d3q_f*t^2*tf*ti^9 + 36*d3q_f*t^3*tf*ti^8 - 300*d3q_f*t^4*tf*ti^7 + 120*d3q_f*t^4*tf^7*ti + 540*d3q_f*t^5*tf*ti^6 - 384*d3q_f*t^5*tf^6*ti - 300*d3q_f*t^6*tf*ti^5 + 372*d3q_f*t^6*tf^5*ti - 132*d3q_f*t^7*tf*ti^4 - 12*d3q_f*t^7*tf^4*ti + 204*d3q_f*t^8*tf*ti^3 - 156*d3q_f*t^8*tf^3*ti - 60*d3q_f*t^9*tf*ti^2 + 60*d3q_f*t^9*tf^2*ti + 4*d4q_f*t*tf^3*ti^9 - 11*d4q_f*t*tf^4*ti^8 + 4*d4q_f*t*tf^5*ti^7 + 14*d4q_f*t*tf^6*ti^6 - 16*d4q_f*t*tf^7*ti^5 + 5*d4q_f*t*tf^8*ti^4 + 4*d4q_f*t^3*tf*ti^9 - 16*d4q_f*t^4*tf*ti^8 - 5*d4q_f*t^4*tf^8*ti + 20*d4q_f*t^5*tf*ti^7 + 16*d4q_f*t^5*tf^7*ti - 14*d4q_f*t^6*tf^6*ti - 20*d4q_f*t^7*tf*ti^5 - 4*d4q_f*t^7*tf^5*ti + 16*d4q_f*t^8*tf*ti^4 + 11*d4q_f*t^8*tf^4*ti - 4*d4q_f*t^9*tf*ti^3 - 4*d4q_f*t^9*tf^3*ti + 120*d3q_i*t*tf^4*ti^7 - 288*d3q_i*t*tf^5*ti^6 + 132*d3q_i*t*tf^6*ti^5 + 132*d3q_i*t*tf^7*ti^4 - 108*d3q_i*t*tf^8*ti^3 + 12*d3q_i*t*tf^9*ti^2 - 12*d3q_i*t^2*tf^9*ti - 36*d3q_i*t^3*tf^8*ti - 120*d3q_i*t^4*tf*ti^7 + 300*d3q_i*t^4*tf^7*ti + 384*d3q_i*t^5*tf*ti^6 - 540*d3q_i*t^5*tf^6*ti - 372*d3q_i*t^6*tf*ti^5 + 300*d3q_i*t^6*tf^5*ti + 12*d3q_i*t^7*tf*ti^4 + 132*d3q_i*t^7*tf^4*ti + 156*d3q_i*t^8*tf*ti^3 - 204*d3q_i*t^8*tf^3*ti - 60*d3q_i*t^9*tf*ti^2 + 60*d3q_i*t^9*tf^2*ti - 5*d4q_i*t*tf^4*ti^8 + 16*d4q_i*t*tf^5*ti^7 - 14*d4q_i*t*tf^6*ti^6 - 4*d4q_i*t*tf^7*ti^5 + 11*d4q_i*t*tf^8*ti^4 - 4*d4q_i*t*tf^9*ti^3 - 4*d4q_i*t^3*tf^9*ti + 5*d4q_i*t^4*tf*ti^8 + 16*d4q_i*t^4*tf^8*ti - 16*d4q_i*t^5*tf*ti^7 - 20*d4q_i*t^5*tf^7*ti + 14*d4q_i*t^6*tf*ti^6 + 4*d4q_i*t^7*tf*ti^5 + 20*d4q_i*t^7*tf^5*ti - 11*d4q_i*t^8*tf*ti^4 - 16*d4q_i*t^8*tf^4*ti + 4*d4q_i*t^9*tf*ti^3 + 4*d4q_i*t^9*tf^3*ti - 216*ddq_f*t*tf^2*ti^8 + 864*ddq_f*t*tf^3*ti^7 + 84*ddq_f*t*tf^4*ti^6 - 2016*ddq_f*t*tf^5*ti^5 + 1260*ddq_f*t*tf^6*ti^4 + 108*ddq_f*t^2*tf*ti^8 - 2100*ddq_f*t^4*tf*ti^6 - 1260*ddq_f*t^4*tf^6*ti + 5040*ddq_f*t^5*tf*ti^5 + 4032*ddq_f*t^5*tf^5*ti - 4284*ddq_f*t^6*tf*ti^4 - 4284*ddq_f*t^6*tf^4*ti + 672*ddq_f*t^7*tf*ti^3 + 1152*ddq_f*t^7*tf^3*ti + 900*ddq_f*t^8*tf*ti^2 + 720*ddq_f*t^8*tf^2*ti - 1260*ddq_i*t*tf^4*ti^6 + 2016*ddq_i*t*tf^5*ti^5 - 84*ddq_i*t*tf^6*ti^4 - 864*ddq_i*t*tf^7*ti^3 + 216*ddq_i*t*tf^8*ti^2 - 108*ddq_i*t^2*tf^8*ti + 1260*ddq_i*t^4*tf*ti^6 + 2100*ddq_i*t^4*tf^6*ti - 4032*ddq_i*t^5*tf*ti^5 - 5040*ddq_i*t^5*tf^5*ti + 4284*ddq_i*t^6*tf*ti^4 + 4284*ddq_i*t^6*tf^4*ti - 1152*ddq_i*t^7*tf*ti^3 - 672*ddq_i*t^7*tf^3*ti - 720*ddq_i*t^8*tf*ti^2 - 900*ddq_i*t^8*tf^2*ti - 864*dq_f*t*tf^2*ti^7 + 2016*dq_f*t*tf^3*ti^6 + 5376*dq_f*t*tf^4*ti^5 - 6720*dq_f*t*tf^5*ti^4 - 8400*dq_f*t^4*tf*ti^5 + 6720*dq_f*t^4*tf^5*ti + 23856*dq_f*t^5*tf*ti^4 - 21504*dq_f*t^5*tf^4*ti - 25536*dq_f*t^6*tf*ti^3 + 24864*dq_f*t^6*tf^3*ti + 10560*dq_f*t^7*tf*ti^2 - 11040*dq_f*t^7*tf^2*ti + 6720*dq_i*t*tf^4*ti^5 - 5376*dq_i*t*tf^5*ti^4 - 2016*dq_i*t*tf^6*ti^3 + 864*dq_i*t*tf^7*ti^2 - 6720*dq_i*t^4*tf*ti^5 + 8400*dq_i*t^4*tf^5*ti + 21504*dq_i*t^5*tf*ti^4 - 23856*dq_i*t^5*tf^4*ti - 24864*dq_i*t^6*tf*ti^3 + 25536*dq_i*t^6*tf^3*ti + 11040*dq_i*t^7*tf*ti^2 - 10560*dq_i*t^7*tf^2*ti + 15120*q_f*t*tf^4*ti^4 - 15120*q_f*t^4*tf*ti^4 - 15120*q_f*t^4*tf^4*ti + 48384*q_f*t^5*tf*ti^3 + 48384*q_f*t^5*tf^3*ti - 60480*q_f*t^6*tf*ti^2 - 60480*q_f*t^6*tf^2*ti - 15120*q_i*t*tf^4*ti^4 + 15120*q_i*t^4*tf*ti^4 + 15120*q_i*t^4*tf^4*ti - 48384*q_i*t^5*tf*ti^3 - 48384*q_i*t^5*tf^3*ti + 60480*q_i*t^6*tf*ti^2 + 60480*q_i*t^6*tf^2*ti))/(tf - ti)^9;
% dq_des = (0.0417*(24*dq_i*tf^9 - 24*dq_f*ti^9 + 15120*q_f*t^8 - 15120*q_i*t^8 + 24*ddq_i*t*tf^9 - 24*ddq_f*t*ti^9 - 7560*dq_f*t^8*tf - 7560*dq_i*t^8*tf + 7560*dq_f*t^8*ti + 7560*dq_i*t^8*ti + 24*ddq_f*tf*ti^9 - 24*ddq_i*tf^9*ti + 216*dq_f*tf*ti^8 - 216*dq_i*tf^8*ti - 60480*q_f*t^7*tf + 60480*q_i*t^7*tf - 60480*q_f*t^7*ti + 60480*q_i*t^7*ti - 120*d3q_f*t^4*tf^7 + 552*d3q_f*t^5*tf^6 - 924*d3q_f*t^6*tf^5 + 672*d3q_f*t^7*tf^4 - 180*d3q_f*t^8*tf^3 + 5*d4q_f*t^4*tf^8 - 24*d4q_f*t^5*tf^7 + 42*d4q_f*t^6*tf^6 - 32*d4q_f*t^7*tf^5 + 9*d4q_f*t^8*tf^4 + 12*d3q_i*t^2*tf^9 - 300*d3q_i*t^4*tf^7 + 960*d3q_i*t^5*tf^6 - 1260*d3q_i*t^6*tf^5 + 768*d3q_i*t^7*tf^4 - 180*d3q_i*t^8*tf^3 + 4*d4q_i*t^3*tf^9 - 25*d4q_i*t^4*tf^8 + 60*d4q_i*t^5*tf^7 - 70*d4q_i*t^6*tf^6 + 40*d4q_i*t^7*tf^5 - 9*d4q_i*t^8*tf^4 - 12*d3q_f*t^2*ti^9 + 300*d3q_f*t^4*ti^7 - 960*d3q_f*t^5*ti^6 + 1260*d3q_f*t^6*ti^5 - 768*d3q_f*t^7*ti^4 + 180*d3q_f*t^8*ti^3 - 4*d4q_f*t^3*ti^9 + 25*d4q_f*t^4*ti^8 - 60*d4q_f*t^5*ti^7 + 70*d4q_f*t^6*ti^6 - 40*d4q_f*t^7*ti^5 + 9*d4q_f*t^8*ti^4 + 120*d3q_i*t^4*ti^7 - 552*d3q_i*t^5*ti^6 + 924*d3q_i*t^6*ti^5 - 672*d3q_i*t^7*ti^4 + 180*d3q_i*t^8*ti^3 - 5*d4q_i*t^4*ti^8 + 24*d4q_i*t^5*ti^7 - 42*d4q_i*t^6*ti^6 + 32*d4q_i*t^7*ti^5 - 9*d4q_i*t^8*ti^4 + 1260*ddq_f*t^4*tf^6 - 5544*ddq_f*t^5*tf^5 + 8904*ddq_f*t^6*tf^4 - 6240*ddq_f*t^7*tf^3 + 1620*ddq_f*t^8*tf^2 - 2100*ddq_i*t^4*tf^6 + 7560*ddq_i*t^5*tf^5 - 10584*ddq_i*t^6*tf^4 + 6720*ddq_i*t^7*tf^3 - 1620*ddq_i*t^8*tf^2 + 2100*ddq_f*t^4*ti^6 - 7560*ddq_f*t^5*ti^5 + 10584*ddq_f*t^6*ti^4 - 6720*ddq_f*t^7*ti^3 + 1620*ddq_f*t^8*ti^2 - 1260*ddq_i*t^4*ti^6 + 5544*ddq_i*t^5*ti^5 - 8904*ddq_i*t^6*ti^4 + 6240*ddq_i*t^7*ti^3 - 1620*ddq_i*t^8*ti^2 - 12*d3q_f*tf^2*ti^9 + 108*d3q_f*tf^3*ti^8 - 132*d3q_f*tf^4*ti^7 - 132*d3q_f*tf^5*ti^6 + 288*d3q_f*tf^6*ti^5 - 120*d3q_f*tf^7*ti^4 + 4*d4q_f*tf^3*ti^9 - 11*d4q_f*tf^4*ti^8 + 4*d4q_f*tf^5*ti^7 + 14*d4q_f*tf^6*ti^6 - 16*d4q_f*tf^7*ti^5 + 5*d4q_f*tf^8*ti^4 + 120*d3q_i*tf^4*ti^7 - 288*d3q_i*tf^5*ti^6 + 132*d3q_i*tf^6*ti^5 + 132*d3q_i*tf^7*ti^4 - 108*d3q_i*tf^8*ti^3 + 12*d3q_i*tf^9*ti^2 - 5*d4q_i*tf^4*ti^8 + 16*d4q_i*tf^5*ti^7 - 14*d4q_i*tf^6*ti^6 - 4*d4q_i*tf^7*ti^5 + 11*d4q_i*tf^8*ti^4 - 4*d4q_i*tf^9*ti^3 - 6720*dq_f*t^4*tf^5 + 28224*dq_f*t^5*tf^4 - 43680*dq_f*t^6*tf^3 + 29760*dq_f*t^7*tf^2 - 8400*dq_i*t^4*tf^5 + 32256*dq_i*t^5*tf^4 - 47040*dq_i*t^6*tf^3 + 30720*dq_i*t^7*tf^2 + 8400*dq_f*t^4*ti^5 - 32256*dq_f*t^5*ti^4 + 47040*dq_f*t^6*ti^3 - 30720*dq_f*t^7*ti^2 + 6720*dq_i*t^4*ti^5 - 28224*dq_i*t^5*ti^4 + 43680*dq_i*t^6*ti^3 - 29760*dq_i*t^7*ti^2 - 216*ddq_f*tf^2*ti^8 + 864*ddq_f*tf^3*ti^7 + 84*ddq_f*tf^4*ti^6 - 2016*ddq_f*tf^5*ti^5 + 1260*ddq_f*tf^6*ti^4 - 1260*ddq_i*tf^4*ti^6 + 2016*ddq_i*tf^5*ti^5 - 84*ddq_i*tf^6*ti^4 - 864*ddq_i*tf^7*ti^3 + 216*ddq_i*tf^8*ti^2 - 864*dq_f*tf^2*ti^7 + 2016*dq_f*tf^3*ti^6 + 5376*dq_f*tf^4*ti^5 - 6720*dq_f*tf^5*ti^4 + 6720*dq_i*tf^4*ti^5 - 5376*dq_i*tf^5*ti^4 - 2016*dq_i*tf^6*ti^3 + 864*dq_i*tf^7*ti^2 + 15120*q_f*t^4*tf^4 - 60480*q_f*t^5*tf^3 + 90720*q_f*t^6*tf^2 - 15120*q_i*t^4*tf^4 + 60480*q_i*t^5*tf^3 - 90720*q_i*t^6*tf^2 + 15120*q_f*t^4*ti^4 - 60480*q_f*t^5*ti^3 + 90720*q_f*t^6*ti^2 - 15120*q_i*t^4*ti^4 + 60480*q_i*t^5*ti^3 - 90720*q_i*t^6*ti^2 + 15120*q_f*tf^4*ti^4 - 15120*q_i*tf^4*ti^4 + 1368*d3q_f*t^2*tf^2*ti^7 - 1992*d3q_f*t^2*tf^3*ti^6 - 2412*d3q_f*t^2*tf^4*ti^5 + 4140*d3q_f*t^2*tf^5*ti^4 - 480*d3q_f*t^2*tf^6*ti^3 - 720*d3q_f*t^2*tf^7*ti^2 - 1200*d3q_f*t^3*tf^2*ti^6 + 7200*d3q_f*t^3*tf^3*ti^5 - 2880*d3q_f*t^3*tf^4*ti^4 - 4560*d3q_f*t^3*tf^5*ti^3 + 2160*d3q_f*t^3*tf^6*ti^2 - 3600*d3q_f*t^4*tf^2*ti^5 - 6120*d3q_f*t^4*tf^3*ti^4 + 8580*d3q_f*t^4*tf^4*ti^3 + 180*d3q_f*t^4*tf^5*ti^2 + 7272*d3q_f*t^5*tf^2*ti^4 - 1968*d3q_f*t^5*tf^3*ti^3 - 5328*d3q_f*t^5*tf^4*ti^2 - 3864*d3q_f*t^6*tf^2*ti^3 + 4536*d3q_f*t^6*tf^3*ti^2 - 288*d3q_f*t^7*tf^2*ti^2 + 42*d4q_f*t^2*tf^2*ti^8 - 168*d4q_f*t^2*tf^3*ti^7 + 42*d4q_f*t^2*tf^4*ti^6 + 252*d4q_f*t^2*tf^5*ti^5 - 210*d4q_f*t^2*tf^6*ti^4 + 30*d4q_f*t^2*tf^8*ti^2 + 56*d4q_f*t^3*tf^2*ti^7 + 336*d4q_f*t^3*tf^3*ti^6 - 504*d4q_f*t^3*tf^4*ti^5 + 280*d4q_f*t^3*tf^6*ti^3 - 80*d4q_f*t^3*tf^7*ti^2 - 350*d4q_f*t^4*tf^2*ti^6 + 630*d4q_f*t^4*tf^4*ti^4 - 420*d4q_f*t^4*tf^5*ti^3 - 70*d4q_f*t^4*tf^6*ti^2 + 420*d4q_f*t^5*tf^2*ti^5 - 504*d4q_f*t^5*tf^3*ti^4 - 84*d4q_f*t^5*tf^4*ti^3 + 336*d4q_f*t^5*tf^5*ti^2 - 98*d4q_f*t^6*tf^2*ti^4 + 392*d4q_f*t^6*tf^3*ti^3 - 238*d4q_f*t^6*tf^4*ti^2 - 112*d4q_f*t^7*tf^2*ti^3 - 32*d4q_f*t^7*tf^3*ti^2 + 54*d4q_f*t^8*tf^2*ti^2 + 720*d3q_i*t^2*tf^2*ti^7 + 480*d3q_i*t^2*tf^3*ti^6 - 4140*d3q_i*t^2*tf^4*ti^5 + 2412*d3q_i*t^2*tf^5*ti^4 + 1992*d3q_i*t^2*tf^6*ti^3 - 1368*d3q_i*t^2*tf^7*ti^2 - 2160*d3q_i*t^3*tf^2*ti^6 + 4560*d3q_i*t^3*tf^3*ti^5 + 2880*d3q_i*t^3*tf^4*ti^4 - 7200*d3q_i*t^3*tf^5*ti^3 + 1200*d3q_i*t^3*tf^6*ti^2 - 180*d3q_i*t^4*tf^2*ti^5 - 8580*d3q_i*t^4*tf^3*ti^4 + 6120*d3q_i*t^4*tf^4*ti^3 + 3600*d3q_i*t^4*tf^5*ti^2 + 5328*d3q_i*t^5*tf^2*ti^4 + 1968*d3q_i*t^5*tf^3*ti^3 - 7272*d3q_i*t^5*tf^4*ti^2 - 4536*d3q_i*t^6*tf^2*ti^3 + 3864*d3q_i*t^6*tf^3*ti^2 + 288*d3q_i*t^7*tf^2*ti^2 - 30*d4q_i*t^2*tf^2*ti^8 + 210*d4q_i*t^2*tf^4*ti^6 - 252*d4q_i*t^2*tf^5*ti^5 - 42*d4q_i*t^2*tf^6*ti^4 + 168*d4q_i*t^2*tf^7*ti^3 - 42*d4q_i*t^2*tf^8*ti^2 + 80*d4q_i*t^3*tf^2*ti^7 - 280*d4q_i*t^3*tf^3*ti^6 + 504*d4q_i*t^3*tf^5*ti^4 - 336*d4q_i*t^3*tf^6*ti^3 - 56*d4q_i*t^3*tf^7*ti^2 + 70*d4q_i*t^4*tf^2*ti^6 + 420*d4q_i*t^4*tf^3*ti^5 - 630*d4q_i*t^4*tf^4*ti^4 + 350*d4q_i*t^4*tf^6*ti^2 - 336*d4q_i*t^5*tf^2*ti^5 + 84*d4q_i*t^5*tf^3*ti^4 + 504*d4q_i*t^5*tf^4*ti^3 - 420*d4q_i*t^5*tf^5*ti^2 + 238*d4q_i*t^6*tf^2*ti^4 - 392*d4q_i*t^6*tf^3*ti^3 + 98*d4q_i*t^6*tf^4*ti^2 + 32*d4q_i*t^7*tf^2*ti^3 + 112*d4q_i*t^7*tf^3*ti^2 - 54*d4q_i*t^8*tf^2*ti^2 + 12600*ddq_f*t^2*tf^2*ti^6 - 30240*ddq_f*t^2*tf^4*ti^4 + 10080*ddq_f*t^2*tf^5*ti^3 + 7560*ddq_f*t^2*tf^6*ti^2 - 25200*ddq_f*t^3*tf^2*ti^5 + 40320*ddq_f*t^3*tf^3*ti^4 + 23520*ddq_f*t^3*tf^4*ti^3 - 25200*ddq_f*t^3*tf^5*ti^2 + 1260*ddq_f*t^4*tf^2*ti^4 - 63840*ddq_f*t^4*tf^3*ti^3 + 13860*ddq_f*t^4*tf^4*ti^2 + 37296*ddq_f*t^5*tf^2*ti^3 + 27216*ddq_f*t^5*tf^3*ti^2 - 32256*ddq_f*t^6*tf^2*ti^2 - 7560*ddq_i*t^2*tf^2*ti^6 - 10080*ddq_i*t^2*tf^3*ti^5 + 30240*ddq_i*t^2*tf^4*ti^4 - 12600*ddq_i*t^2*tf^6*ti^2 + 25200*ddq_i*t^3*tf^2*ti^5 - 23520*ddq_i*t^3*tf^3*ti^4 - 40320*ddq_i*t^3*tf^4*ti^3 + 25200*ddq_i*t^3*tf^5*ti^2 - 13860*ddq_i*t^4*tf^2*ti^4 + 63840*ddq_i*t^4*tf^3*ti^3 - 1260*ddq_i*t^4*tf^4*ti^2 - 27216*ddq_i*t^5*tf^2*ti^3 - 37296*ddq_i*t^5*tf^3*ti^2 + 32256*ddq_i*t^6*tf^2*ti^2 + 50400*dq_f*t^2*tf^2*ti^5 + 70560*dq_f*t^2*tf^3*ti^4 - 80640*dq_f*t^2*tf^4*ti^3 - 40320*dq_f*t^2*tf^5*ti^2 - 154560*dq_f*t^3*tf^2*ti^4 + 13440*dq_f*t^3*tf^3*ti^3 + 147840*dq_f*t^3*tf^4*ti^2 + 144480*dq_f*t^4*tf^2*ti^3 - 157920*dq_f*t^4*tf^3*ti^2 + 8064*dq_f*t^5*tf^2*ti^2 + 40320*dq_i*t^2*tf^2*ti^5 + 80640*dq_i*t^2*tf^3*ti^4 - 70560*dq_i*t^2*tf^4*ti^3 - 50400*dq_i*t^2*tf^5*ti^2 - 147840*dq_i*t^3*tf^2*ti^4 - 13440*dq_i*t^3*tf^3*ti^3 + 154560*dq_i*t^3*tf^4*ti^2 + 157920*dq_i*t^4*tf^2*ti^3 - 144480*dq_i*t^4*tf^3*ti^2 - 8064*dq_i*t^5*tf^2*ti^2 + 90720*q_f*t^2*tf^2*ti^4 + 241920*q_f*t^2*tf^3*ti^3 + 90720*q_f*t^2*tf^4*ti^2 - 362880*q_f*t^3*tf^2*ti^3 - 362880*q_f*t^3*tf^3*ti^2 + 544320*q_f*t^4*tf^2*ti^2 - 90720*q_i*t^2*tf^2*ti^4 - 241920*q_i*t^2*tf^3*ti^3 - 90720*q_i*t^2*tf^4*ti^2 + 362880*q_i*t^3*tf^2*ti^3 + 362880*q_i*t^3*tf^3*ti^2 - 544320*q_i*t^4*tf^2*ti^2 + 24*d3q_f*t*tf*ti^9 - 24*d3q_i*t*tf^9*ti + 216*ddq_f*t*tf*ti^8 - 3240*ddq_f*t^8*tf*ti - 216*ddq_i*t*tf^8*ti + 3240*ddq_i*t^8*tf*ti + 960*dq_f*t^7*tf*ti - 960*dq_i*t^7*tf*ti + 241920*q_f*t^6*tf*ti - 241920*q_i*t^6*tf*ti - 216*d3q_f*t*tf^2*ti^8 - 336*d3q_f*t*tf^3*ti^7 + 1584*d3q_f*t*tf^4*ti^6 - 936*d3q_f*t*tf^5*ti^5 - 600*d3q_f*t*tf^6*ti^4 + 480*d3q_f*t*tf^7*ti^3 + 108*d3q_f*t^2*tf*ti^8 - 1200*d3q_f*t^3*tf*ti^7 + 480*d3q_f*t^3*tf^7*ti + 2700*d3q_f*t^4*tf*ti^6 - 1920*d3q_f*t^4*tf^6*ti - 1800*d3q_f*t^5*tf*ti^5 + 2232*d3q_f*t^5*tf^5*ti - 924*d3q_f*t^6*tf*ti^4 - 84*d3q_f*t^6*tf^4*ti + 1632*d3q_f*t^7*tf*ti^3 - 1248*d3q_f*t^7*tf^3*ti - 540*d3q_f*t^8*tf*ti^2 + 540*d3q_f*t^8*tf^2*ti - 12*d4q_f*t*tf^2*ti^9 + 8*d4q_f*t*tf^3*ti^8 + 68*d4q_f*t*tf^4*ti^7 - 112*d4q_f*t*tf^5*ti^6 + 28*d4q_f*t*tf^6*ti^5 + 40*d4q_f*t*tf^7*ti^4 - 20*d4q_f*t*tf^8*ti^3 + 12*d4q_f*t^2*tf*ti^9 - 64*d4q_f*t^3*tf*ti^8 - 20*d4q_f*t^3*tf^8*ti + 100*d4q_f*t^4*tf*ti^7 + 80*d4q_f*t^4*tf^7*ti - 84*d4q_f*t^5*tf^6*ti - 140*d4q_f*t^6*tf*ti^5 - 28*d4q_f*t^6*tf^5*ti + 128*d4q_f*t^7*tf*ti^4 + 88*d4q_f*t^7*tf^4*ti - 36*d4q_f*t^8*tf*ti^3 - 36*d4q_f*t^8*tf^3*ti - 480*d3q_i*t*tf^3*ti^7 + 600*d3q_i*t*tf^4*ti^6 + 936*d3q_i*t*tf^5*ti^5 - 1584*d3q_i*t*tf^6*ti^4 + 336*d3q_i*t*tf^7*ti^3 + 216*d3q_i*t*tf^8*ti^2 - 108*d3q_i*t^2*tf^8*ti - 480*d3q_i*t^3*tf*ti^7 + 1200*d3q_i*t^3*tf^7*ti + 1920*d3q_i*t^4*tf*ti^6 - 2700*d3q_i*t^4*tf^6*ti - 2232*d3q_i*t^5*tf*ti^5 + 1800*d3q_i*t^5*tf^5*ti + 84*d3q_i*t^6*tf*ti^4 + 924*d3q_i*t^6*tf^4*ti + 1248*d3q_i*t^7*tf*ti^3 - 1632*d3q_i*t^7*tf^3*ti - 540*d3q_i*t^8*tf*ti^2 + 540*d3q_i*t^8*tf^2*ti + 20*d4q_i*t*tf^3*ti^8 - 40*d4q_i*t*tf^4*ti^7 - 28*d4q_i*t*tf^5*ti^6 + 112*d4q_i*t*tf^6*ti^5 - 68*d4q_i*t*tf^7*ti^4 - 8*d4q_i*t*tf^8*ti^3 + 12*d4q_i*t*tf^9*ti^2 - 12*d4q_i*t^2*tf^9*ti + 20*d4q_i*t^3*tf*ti^8 + 64*d4q_i*t^3*tf^8*ti - 80*d4q_i*t^4*tf*ti^7 - 100*d4q_i*t^4*tf^7*ti + 84*d4q_i*t^5*tf*ti^6 + 28*d4q_i*t^6*tf*ti^5 + 140*d4q_i*t^6*tf^5*ti - 88*d4q_i*t^7*tf*ti^4 - 128*d4q_i*t^7*tf^4*ti + 36*d4q_i*t^8*tf*ti^3 + 36*d4q_i*t^8*tf^3*ti - 864*ddq_f*t*tf^2*ti^7 - 6384*ddq_f*t*tf^3*ti^6 + 9576*ddq_f*t*tf^4*ti^5 + 2520*ddq_f*t*tf^5*ti^4 - 5040*ddq_f*t*tf^6*ti^3 - 8400*ddq_f*t^3*tf*ti^6 - 5040*ddq_f*t^3*tf^6*ti + 25200*ddq_f*t^4*tf*ti^5 + 20160*ddq_f*t^4*tf^5*ti - 25704*ddq_f*t^5*tf*ti^4 - 25704*ddq_f*t^5*tf^4*ti + 4704*ddq_f*t^6*tf*ti^3 + 8064*ddq_f*t^6*tf^3*ti + 7200*ddq_f*t^7*tf*ti^2 + 5760*ddq_f*t^7*tf^2*ti + 5040*ddq_i*t*tf^3*ti^6 - 2520*ddq_i*t*tf^4*ti^5 - 9576*ddq_i*t*tf^5*ti^4 + 6384*ddq_i*t*tf^6*ti^3 + 864*ddq_i*t*tf^7*ti^2 + 5040*ddq_i*t^3*tf*ti^6 + 8400*ddq_i*t^3*tf^6*ti - 20160*ddq_i*t^4*tf*ti^5 - 25200*ddq_i*t^4*tf^5*ti + 25704*ddq_i*t^5*tf*ti^4 + 25704*ddq_i*t^5*tf^4*ti - 8064*ddq_i*t^6*tf*ti^3 - 4704*ddq_i*t^6*tf^3*ti - 5760*ddq_i*t^7*tf*ti^2 - 7200*ddq_i*t^7*tf^2*ti - 33600*dq_f*t*tf^3*ti^5 + 6720*dq_f*t*tf^4*ti^4 + 26880*dq_f*t*tf^5*ti^3 - 33600*dq_f*t^3*tf*ti^5 + 26880*dq_f*t^3*tf^5*ti + 119280*dq_f*t^4*tf*ti^4 - 107520*dq_f*t^4*tf^4*ti - 153216*dq_f*t^5*tf*ti^3 + 149184*dq_f*t^5*tf^3*ti + 73920*dq_f*t^6*tf*ti^2 - 77280*dq_f*t^6*tf^2*ti - 26880*dq_i*t*tf^3*ti^5 - 6720*dq_i*t*tf^4*ti^4 + 33600*dq_i*t*tf^5*ti^3 - 26880*dq_i*t^3*tf*ti^5 + 33600*dq_i*t^3*tf^5*ti + 107520*dq_i*t^4*tf*ti^4 - 119280*dq_i*t^4*tf^4*ti - 149184*dq_i*t^5*tf*ti^3 + 153216*dq_i*t^5*tf^3*ti + 77280*dq_i*t^6*tf*ti^2 - 73920*dq_i*t^6*tf^2*ti - 60480*q_f*t*tf^3*ti^4 - 60480*q_f*t*tf^4*ti^3 - 60480*q_f*t^3*tf*ti^4 - 60480*q_f*t^3*tf^4*ti + 241920*q_f*t^4*tf*ti^3 + 241920*q_f*t^4*tf^3*ti - 362880*q_f*t^5*tf*ti^2 - 362880*q_f*t^5*tf^2*ti + 60480*q_i*t*tf^3*ti^4 + 60480*q_i*t*tf^4*ti^3 + 60480*q_i*t^3*tf*ti^4 + 60480*q_i*t^3*tf^4*ti - 241920*q_i*t^4*tf*ti^3 - 241920*q_i*t^4*tf^3*ti + 362880*q_i*t^5*tf*ti^2 + 362880*q_i*t^5*tf^2*ti))/(tf - ti)^9;
% ddq_des = (0.1667*(6*ddq_i*tf^9 - 6*ddq_f*ti^9 + 30240*q_f*t^7 - 30240*q_i*t^7 + 6*d3q_i*t*tf^9 - 6*d3q_f*t*ti^9 + 6*d3q_f*tf*ti^9 - 6*d3q_i*tf^9*ti - 15120*dq_f*t^7*tf - 15120*dq_i*t^7*tf + 15120*dq_f*t^7*ti + 15120*dq_i*t^7*ti + 54*ddq_f*tf*ti^8 - 54*ddq_i*tf^8*ti - 105840*q_f*t^6*tf + 105840*q_i*t^6*tf - 105840*q_f*t^6*ti + 105840*q_i*t^6*ti - 120*d3q_f*t^3*tf^7 + 690*d3q_f*t^4*tf^6 - 1386*d3q_f*t^5*tf^5 + 1176*d3q_f*t^6*tf^4 - 360*d3q_f*t^7*tf^3 + 5*d4q_f*t^3*tf^8 - 30*d4q_f*t^4*tf^7 + 63*d4q_f*t^5*tf^6 - 56*d4q_f*t^6*tf^5 + 18*d4q_f*t^7*tf^4 - 300*d3q_i*t^3*tf^7 + 1200*d3q_i*t^4*tf^6 - 1890*d3q_i*t^5*tf^5 + 1344*d3q_i*t^6*tf^4 - 360*d3q_i*t^7*tf^3 + 3*d4q_i*t^2*tf^9 - 25*d4q_i*t^3*tf^8 + 75*d4q_i*t^4*tf^7 - 105*d4q_i*t^5*tf^6 + 70*d4q_i*t^6*tf^5 - 18*d4q_i*t^7*tf^4 + 300*d3q_f*t^3*ti^7 - 1200*d3q_f*t^4*ti^6 + 1890*d3q_f*t^5*ti^5 - 1344*d3q_f*t^6*ti^4 + 360*d3q_f*t^7*ti^3 - 3*d4q_f*t^2*ti^9 + 25*d4q_f*t^3*ti^8 - 75*d4q_f*t^4*ti^7 + 105*d4q_f*t^5*ti^6 - 70*d4q_f*t^6*ti^5 + 18*d4q_f*t^7*ti^4 + 120*d3q_i*t^3*ti^7 - 690*d3q_i*t^4*ti^6 + 1386*d3q_i*t^5*ti^5 - 1176*d3q_i*t^6*ti^4 + 360*d3q_i*t^7*ti^3 - 5*d4q_i*t^3*ti^8 + 30*d4q_i*t^4*ti^7 - 63*d4q_i*t^5*ti^6 + 56*d4q_i*t^6*ti^5 - 18*d4q_i*t^7*ti^4 + 1260*ddq_f*t^3*tf^6 - 6930*ddq_f*t^4*tf^5 + 13356*ddq_f*t^5*tf^4 - 10920*ddq_f*t^6*tf^3 + 3240*ddq_f*t^7*tf^2 - 2100*ddq_i*t^3*tf^6 + 9450*ddq_i*t^4*tf^5 - 15876*ddq_i*t^5*tf^4 + 11760*ddq_i*t^6*tf^3 - 3240*ddq_i*t^7*tf^2 + 2100*ddq_f*t^3*ti^6 - 9450*ddq_f*t^4*ti^5 + 15876*ddq_f*t^5*ti^4 - 11760*ddq_f*t^6*ti^3 + 3240*ddq_f*t^7*ti^2 - 1260*ddq_i*t^3*ti^6 + 6930*ddq_i*t^4*ti^5 - 13356*ddq_i*t^5*ti^4 + 10920*ddq_i*t^6*ti^3 - 3240*ddq_i*t^7*ti^2 - 54*d3q_f*tf^2*ti^8 - 84*d3q_f*tf^3*ti^7 + 396*d3q_f*tf^4*ti^6 - 234*d3q_f*tf^5*ti^5 - 150*d3q_f*tf^6*ti^4 + 120*d3q_f*tf^7*ti^3 - 3*d4q_f*tf^2*ti^9 + 2*d4q_f*tf^3*ti^8 + 17*d4q_f*tf^4*ti^7 - 28*d4q_f*tf^5*ti^6 + 7*d4q_f*tf^6*ti^5 + 10*d4q_f*tf^7*ti^4 - 5*d4q_f*tf^8*ti^3 - 120*d3q_i*tf^3*ti^7 + 150*d3q_i*tf^4*ti^6 + 234*d3q_i*tf^5*ti^5 - 396*d3q_i*tf^6*ti^4 + 84*d3q_i*tf^7*ti^3 + 54*d3q_i*tf^8*ti^2 + 5*d4q_i*tf^3*ti^8 - 10*d4q_i*tf^4*ti^7 - 7*d4q_i*tf^5*ti^6 + 28*d4q_i*tf^6*ti^5 - 17*d4q_i*tf^7*ti^4 - 2*d4q_i*tf^8*ti^3 + 3*d4q_i*tf^9*ti^2 - 6720*dq_f*t^3*tf^5 + 35280*dq_f*t^4*tf^4 - 65520*dq_f*t^5*tf^3 + 52080*dq_f*t^6*tf^2 - 8400*dq_i*t^3*tf^5 + 40320*dq_i*t^4*tf^4 - 70560*dq_i*t^5*tf^3 + 53760*dq_i*t^6*tf^2 + 8400*dq_f*t^3*ti^5 - 40320*dq_f*t^4*ti^4 + 70560*dq_f*t^5*ti^3 - 53760*dq_f*t^6*ti^2 + 6720*dq_i*t^3*ti^5 - 35280*dq_i*t^4*ti^4 + 65520*dq_i*t^5*ti^3 - 52080*dq_i*t^6*ti^2 - 216*ddq_f*tf^2*ti^7 - 1596*ddq_f*tf^3*ti^6 + 2394*ddq_f*tf^4*ti^5 + 630*ddq_f*tf^5*ti^4 - 1260*ddq_f*tf^6*ti^3 + 1260*ddq_i*tf^3*ti^6 - 630*ddq_i*tf^4*ti^5 - 2394*ddq_i*tf^5*ti^4 + 1596*ddq_i*tf^6*ti^3 + 216*ddq_i*tf^7*ti^2 - 8400*dq_f*tf^3*ti^5 + 1680*dq_f*tf^4*ti^4 + 6720*dq_f*tf^5*ti^3 - 6720*dq_i*tf^3*ti^5 - 1680*dq_i*tf^4*ti^4 + 8400*dq_i*tf^5*ti^3 + 15120*q_f*t^3*tf^4 - 75600*q_f*t^4*tf^3 + 136080*q_f*t^5*tf^2 - 15120*q_i*t^3*tf^4 + 75600*q_i*t^4*tf^3 - 136080*q_i*t^5*tf^2 + 15120*q_f*t^3*ti^4 - 75600*q_f*t^4*ti^3 + 136080*q_f*t^5*ti^2 - 15120*q_i*t^3*ti^4 + 75600*q_i*t^4*ti^3 - 136080*q_i*t^5*ti^2 - 15120*q_f*tf^3*ti^4 - 15120*q_f*tf^4*ti^3 + 15120*q_i*tf^3*ti^4 + 15120*q_i*tf^4*ti^3 - 900*d3q_f*t^2*tf^2*ti^6 + 5400*d3q_f*t^2*tf^3*ti^5 - 2160*d3q_f*t^2*tf^4*ti^4 - 3420*d3q_f*t^2*tf^5*ti^3 + 1620*d3q_f*t^2*tf^6*ti^2 - 3600*d3q_f*t^3*tf^2*ti^5 - 6120*d3q_f*t^3*tf^3*ti^4 + 8580*d3q_f*t^3*tf^4*ti^3 + 180*d3q_f*t^3*tf^5*ti^2 + 9090*d3q_f*t^4*tf^2*ti^4 - 2460*d3q_f*t^4*tf^3*ti^3 - 6660*d3q_f*t^4*tf^4*ti^2 - 5796*d3q_f*t^5*tf^2*ti^3 + 6804*d3q_f*t^5*tf^3*ti^2 - 504*d3q_f*t^6*tf^2*ti^2 + 42*d4q_f*t^2*tf^2*ti^7 + 252*d4q_f*t^2*tf^3*ti^6 - 378*d4q_f*t^2*tf^4*ti^5 + 210*d4q_f*t^2*tf^6*ti^3 - 60*d4q_f*t^2*tf^7*ti^2 - 350*d4q_f*t^3*tf^2*ti^6 + 630*d4q_f*t^3*tf^4*ti^4 - 420*d4q_f*t^3*tf^5*ti^3 - 70*d4q_f*t^3*tf^6*ti^2 + 525*d4q_f*t^4*tf^2*ti^5 - 630*d4q_f*t^4*tf^3*ti^4 - 105*d4q_f*t^4*tf^4*ti^3 + 420*d4q_f*t^4*tf^5*ti^2 - 147*d4q_f*t^5*tf^2*ti^4 + 588*d4q_f*t^5*tf^3*ti^3 - 357*d4q_f*t^5*tf^4*ti^2 - 196*d4q_f*t^6*tf^2*ti^3 - 56*d4q_f*t^6*tf^3*ti^2 + 108*d4q_f*t^7*tf^2*ti^2 - 1620*d3q_i*t^2*tf^2*ti^6 + 3420*d3q_i*t^2*tf^3*ti^5 + 2160*d3q_i*t^2*tf^4*ti^4 - 5400*d3q_i*t^2*tf^5*ti^3 + 900*d3q_i*t^2*tf^6*ti^2 - 180*d3q_i*t^3*tf^2*ti^5 - 8580*d3q_i*t^3*tf^3*ti^4 + 6120*d3q_i*t^3*tf^4*ti^3 + 3600*d3q_i*t^3*tf^5*ti^2 + 6660*d3q_i*t^4*tf^2*ti^4 + 2460*d3q_i*t^4*tf^3*ti^3 - 9090*d3q_i*t^4*tf^4*ti^2 - 6804*d3q_i*t^5*tf^2*ti^3 + 5796*d3q_i*t^5*tf^3*ti^2 + 504*d3q_i*t^6*tf^2*ti^2 + 60*d4q_i*t^2*tf^2*ti^7 - 210*d4q_i*t^2*tf^3*ti^6 + 378*d4q_i*t^2*tf^5*ti^4 - 252*d4q_i*t^2*tf^6*ti^3 - 42*d4q_i*t^2*tf^7*ti^2 + 70*d4q_i*t^3*tf^2*ti^6 + 420*d4q_i*t^3*tf^3*ti^5 - 630*d4q_i*t^3*tf^4*ti^4 + 350*d4q_i*t^3*tf^6*ti^2 - 420*d4q_i*t^4*tf^2*ti^5 + 105*d4q_i*t^4*tf^3*ti^4 + 630*d4q_i*t^4*tf^4*ti^3 - 525*d4q_i*t^4*tf^5*ti^2 + 357*d4q_i*t^5*tf^2*ti^4 - 588*d4q_i*t^5*tf^3*ti^3 + 147*d4q_i*t^5*tf^4*ti^2 + 56*d4q_i*t^6*tf^2*ti^3 + 196*d4q_i*t^6*tf^3*ti^2 - 108*d4q_i*t^7*tf^2*ti^2 - 18900*ddq_f*t^2*tf^2*ti^5 + 30240*ddq_f*t^2*tf^3*ti^4 + 17640*ddq_f*t^2*tf^4*ti^3 - 18900*ddq_f*t^2*tf^5*ti^2 + 1260*ddq_f*t^3*tf^2*ti^4 - 63840*ddq_f*t^3*tf^3*ti^3 + 13860*ddq_f*t^3*tf^4*ti^2 + 46620*ddq_f*t^4*tf^2*ti^3 + 34020*ddq_f*t^4*tf^3*ti^2 - 48384*ddq_f*t^5*tf^2*ti^2 + 18900*ddq_i*t^2*tf^2*ti^5 - 17640*ddq_i*t^2*tf^3*ti^4 - 30240*ddq_i*t^2*tf^4*ti^3 + 18900*ddq_i*t^2*tf^5*ti^2 - 13860*ddq_i*t^3*tf^2*ti^4 + 63840*ddq_i*t^3*tf^3*ti^3 - 1260*ddq_i*t^3*tf^4*ti^2 - 34020*ddq_i*t^4*tf^2*ti^3 - 46620*ddq_i*t^4*tf^3*ti^2 + 48384*ddq_i*t^5*tf^2*ti^2 - 115920*dq_f*t^2*tf^2*ti^4 + 10080*dq_f*t^2*tf^3*ti^3 + 110880*dq_f*t^2*tf^4*ti^2 + 144480*dq_f*t^3*tf^2*ti^3 - 157920*dq_f*t^3*tf^3*ti^2 + 10080*dq_f*t^4*tf^2*ti^2 - 110880*dq_i*t^2*tf^2*ti^4 - 10080*dq_i*t^2*tf^3*ti^3 + 115920*dq_i*t^2*tf^4*ti^2 + 157920*dq_i*t^3*tf^2*ti^3 - 144480*dq_i*t^3*tf^3*ti^2 - 10080*dq_i*t^4*tf^2*ti^2 - 272160*q_f*t^2*tf^2*ti^3 - 272160*q_f*t^2*tf^3*ti^2 + 544320*q_f*t^3*tf^2*ti^2 + 272160*q_i*t^2*tf^2*ti^3 + 272160*q_i*t^2*tf^3*ti^2 - 544320*q_i*t^3*tf^2*ti^2 + 54*d3q_f*t*tf*ti^8 + 6*d4q_f*t*tf*ti^9 - 54*d3q_i*t*tf^8*ti - 6*d4q_i*t*tf^9*ti - 6480*ddq_f*t^7*tf*ti + 6480*ddq_i*t^7*tf*ti + 1680*dq_f*t^6*tf*ti - 1680*dq_i*t^6*tf*ti + 362880*q_f*t^5*tf*ti - 362880*q_i*t^5*tf*ti + 684*d3q_f*t*tf^2*ti^7 - 996*d3q_f*t*tf^3*ti^6 - 1206*d3q_f*t*tf^4*ti^5 + 2070*d3q_f*t*tf^5*ti^4 - 240*d3q_f*t*tf^6*ti^3 - 360*d3q_f*t*tf^7*ti^2 - 900*d3q_f*t^2*tf*ti^7 + 360*d3q_f*t^2*tf^7*ti + 2700*d3q_f*t^3*tf*ti^6 - 1920*d3q_f*t^3*tf^6*ti - 2250*d3q_f*t^4*tf*ti^5 + 2790*d3q_f*t^4*tf^5*ti - 1386*d3q_f*t^5*tf*ti^4 - 126*d3q_f*t^5*tf^4*ti + 2856*d3q_f*t^6*tf*ti^3 - 2184*d3q_f*t^6*tf^3*ti - 1080*d3q_f*t^7*tf*ti^2 + 1080*d3q_f*t^7*tf^2*ti + 21*d4q_f*t*tf^2*ti^8 - 84*d4q_f*t*tf^3*ti^7 + 21*d4q_f*t*tf^4*ti^6 + 126*d4q_f*t*tf^5*ti^5 - 105*d4q_f*t*tf^6*ti^4 + 15*d4q_f*t*tf^8*ti^2 - 48*d4q_f*t^2*tf*ti^8 - 15*d4q_f*t^2*tf^8*ti + 100*d4q_f*t^3*tf*ti^7 + 80*d4q_f*t^3*tf^7*ti - 105*d4q_f*t^4*tf^6*ti - 210*d4q_f*t^5*tf*ti^5 - 42*d4q_f*t^5*tf^5*ti + 224*d4q_f*t^6*tf*ti^4 + 154*d4q_f*t^6*tf^4*ti - 72*d4q_f*t^7*tf*ti^3 - 72*d4q_f*t^7*tf^3*ti + 360*d3q_i*t*tf^2*ti^7 + 240*d3q_i*t*tf^3*ti^6 - 2070*d3q_i*t*tf^4*ti^5 + 1206*d3q_i*t*tf^5*ti^4 + 996*d3q_i*t*tf^6*ti^3 - 684*d3q_i*t*tf^7*ti^2 - 360*d3q_i*t^2*tf*ti^7 + 900*d3q_i*t^2*tf^7*ti + 1920*d3q_i*t^3*tf*ti^6 - 2700*d3q_i*t^3*tf^6*ti - 2790*d3q_i*t^4*tf*ti^5 + 2250*d3q_i*t^4*tf^5*ti + 126*d3q_i*t^5*tf*ti^4 + 1386*d3q_i*t^5*tf^4*ti + 2184*d3q_i*t^6*tf*ti^3 - 2856*d3q_i*t^6*tf^3*ti - 1080*d3q_i*t^7*tf*ti^2 + 1080*d3q_i*t^7*tf^2*ti - 15*d4q_i*t*tf^2*ti^8 + 105*d4q_i*t*tf^4*ti^6 - 126*d4q_i*t*tf^5*ti^5 - 21*d4q_i*t*tf^6*ti^4 + 84*d4q_i*t*tf^7*ti^3 - 21*d4q_i*t*tf^8*ti^2 + 15*d4q_i*t^2*tf*ti^8 + 48*d4q_i*t^2*tf^8*ti - 80*d4q_i*t^3*tf*ti^7 - 100*d4q_i*t^3*tf^7*ti + 105*d4q_i*t^4*tf*ti^6 + 42*d4q_i*t^5*tf*ti^5 + 210*d4q_i*t^5*tf^5*ti - 154*d4q_i*t^6*tf*ti^4 - 224*d4q_i*t^6*tf^4*ti + 72*d4q_i*t^7*tf*ti^3 + 72*d4q_i*t^7*tf^3*ti + 6300*ddq_f*t*tf^2*ti^6 - 15120*ddq_f*t*tf^4*ti^4 + 5040*ddq_f*t*tf^5*ti^3 + 3780*ddq_f*t*tf^6*ti^2 - 6300*ddq_f*t^2*tf*ti^6 - 3780*ddq_f*t^2*tf^6*ti + 25200*ddq_f*t^3*tf*ti^5 + 20160*ddq_f*t^3*tf^5*ti - 32130*ddq_f*t^4*tf*ti^4 - 32130*ddq_f*t^4*tf^4*ti + 7056*ddq_f*t^5*tf*ti^3 + 12096*ddq_f*t^5*tf^3*ti + 12600*ddq_f*t^6*tf*ti^2 + 10080*ddq_f*t^6*tf^2*ti - 3780*ddq_i*t*tf^2*ti^6 - 5040*ddq_i*t*tf^3*ti^5 + 15120*ddq_i*t*tf^4*ti^4 - 6300*ddq_i*t*tf^6*ti^2 + 3780*ddq_i*t^2*tf*ti^6 + 6300*ddq_i*t^2*tf^6*ti - 20160*ddq_i*t^3*tf*ti^5 - 25200*ddq_i*t^3*tf^5*ti + 32130*ddq_i*t^4*tf*ti^4 + 32130*ddq_i*t^4*tf^4*ti - 12096*ddq_i*t^5*tf*ti^3 - 7056*ddq_i*t^5*tf^3*ti - 10080*ddq_i*t^6*tf*ti^2 - 12600*ddq_i*t^6*tf^2*ti + 25200*dq_f*t*tf^2*ti^5 + 35280*dq_f*t*tf^3*ti^4 - 40320*dq_f*t*tf^4*ti^3 - 20160*dq_f*t*tf^5*ti^2 - 25200*dq_f*t^2*tf*ti^5 + 20160*dq_f*t^2*tf^5*ti + 119280*dq_f*t^3*tf*ti^4 - 107520*dq_f*t^3*tf^4*ti - 191520*dq_f*t^4*tf*ti^3 + 186480*dq_f*t^4*tf^3*ti + 110880*dq_f*t^5*tf*ti^2 - 115920*dq_f*t^5*tf^2*ti + 20160*dq_i*t*tf^2*ti^5 + 40320*dq_i*t*tf^3*ti^4 - 35280*dq_i*t*tf^4*ti^3 - 25200*dq_i*t*tf^5*ti^2 - 20160*dq_i*t^2*tf*ti^5 + 25200*dq_i*t^2*tf^5*ti + 107520*dq_i*t^3*tf*ti^4 - 119280*dq_i*t^3*tf^4*ti - 186480*dq_i*t^4*tf*ti^3 + 191520*dq_i*t^4*tf^3*ti + 115920*dq_i*t^5*tf*ti^2 - 110880*dq_i*t^5*tf^2*ti + 45360*q_f*t*tf^2*ti^4 + 120960*q_f*t*tf^3*ti^3 + 45360*q_f*t*tf^4*ti^2 - 45360*q_f*t^2*tf*ti^4 - 45360*q_f*t^2*tf^4*ti + 241920*q_f*t^3*tf*ti^3 + 241920*q_f*t^3*tf^3*ti - 453600*q_f*t^4*tf*ti^2 - 453600*q_f*t^4*tf^2*ti - 45360*q_i*t*tf^2*ti^4 - 120960*q_i*t*tf^3*ti^3 - 45360*q_i*t*tf^4*ti^2 + 45360*q_i*t^2*tf*ti^4 + 45360*q_i*t^2*tf^4*ti - 241920*q_i*t^3*tf*ti^3 - 241920*q_i*t^3*tf^3*ti + 453600*q_i*t^4*tf*ti^2 + 453600*q_i*t^4*tf^2*ti))/(tf - ti)^9;
% d3q_des = (0.5000*(2*d3q_i*tf^9 - 2*d3q_f*ti^9 + 70560*q_f*t^6 - 70560*q_i*t^6 + 2*d4q_i*t*tf^9 - 2*d4q_f*t*ti^9 + 18*d3q_f*tf*ti^8 + 2*d4q_f*tf*ti^9 - 18*d3q_i*tf^8*ti - 2*d4q_i*tf^9*ti - 35280*dq_f*t^6*tf - 35280*dq_i*t^6*tf + 35280*dq_f*t^6*ti + 35280*dq_i*t^6*ti - 211680*q_f*t^5*tf + 211680*q_i*t^5*tf - 211680*q_f*t^5*ti + 211680*q_i*t^5*ti - 120*d3q_f*t^2*tf^7 + 920*d3q_f*t^3*tf^6 - 2310*d3q_f*t^4*tf^5 + 2352*d3q_f*t^5*tf^4 - 840*d3q_f*t^6*tf^3 + 5*d4q_f*t^2*tf^8 - 40*d4q_f*t^3*tf^7 + 105*d4q_f*t^4*tf^6 - 112*d4q_f*t^5*tf^5 + 42*d4q_f*t^6*tf^4 - 300*d3q_i*t^2*tf^7 + 1600*d3q_i*t^3*tf^6 - 3150*d3q_i*t^4*tf^5 + 2688*d3q_i*t^5*tf^4 - 840*d3q_i*t^6*tf^3 - 25*d4q_i*t^2*tf^8 + 100*d4q_i*t^3*tf^7 - 175*d4q_i*t^4*tf^6 + 140*d4q_i*t^5*tf^5 - 42*d4q_i*t^6*tf^4 + 300*d3q_f*t^2*ti^7 - 1600*d3q_f*t^3*ti^6 + 3150*d3q_f*t^4*ti^5 - 2688*d3q_f*t^5*ti^4 + 840*d3q_f*t^6*ti^3 + 25*d4q_f*t^2*ti^8 - 100*d4q_f*t^3*ti^7 + 175*d4q_f*t^4*ti^6 - 140*d4q_f*t^5*ti^5 + 42*d4q_f*t^6*ti^4 + 120*d3q_i*t^2*ti^7 - 920*d3q_i*t^3*ti^6 + 2310*d3q_i*t^4*ti^5 - 2352*d3q_i*t^5*ti^4 + 840*d3q_i*t^6*ti^3 - 5*d4q_i*t^2*ti^8 + 40*d4q_i*t^3*ti^7 - 105*d4q_i*t^4*ti^6 + 112*d4q_i*t^5*ti^5 - 42*d4q_i*t^6*ti^4 + 1260*ddq_f*t^2*tf^6 - 9240*ddq_f*t^3*tf^5 + 22260*ddq_f*t^4*tf^4 - 21840*ddq_f*t^5*tf^3 + 7560*ddq_f*t^6*tf^2 - 2100*ddq_i*t^2*tf^6 + 12600*ddq_i*t^3*tf^5 - 26460*ddq_i*t^4*tf^4 + 23520*ddq_i*t^5*tf^3 - 7560*ddq_i*t^6*tf^2 + 2100*ddq_f*t^2*ti^6 - 12600*ddq_f*t^3*ti^5 + 26460*ddq_f*t^4*ti^4 - 23520*ddq_f*t^5*ti^3 + 7560*ddq_f*t^6*ti^2 - 1260*ddq_i*t^2*ti^6 + 9240*ddq_i*t^3*ti^5 - 22260*ddq_i*t^4*ti^4 + 21840*ddq_i*t^5*ti^3 - 7560*ddq_i*t^6*ti^2 + 228*d3q_f*tf^2*ti^7 - 332*d3q_f*tf^3*ti^6 - 402*d3q_f*tf^4*ti^5 + 690*d3q_f*tf^5*ti^4 - 80*d3q_f*tf^6*ti^3 - 120*d3q_f*tf^7*ti^2 + 7*d4q_f*tf^2*ti^8 - 28*d4q_f*tf^3*ti^7 + 7*d4q_f*tf^4*ti^6 + 42*d4q_f*tf^5*ti^5 - 35*d4q_f*tf^6*ti^4 + 5*d4q_f*tf^8*ti^2 + 120*d3q_i*tf^2*ti^7 + 80*d3q_i*tf^3*ti^6 - 690*d3q_i*tf^4*ti^5 + 402*d3q_i*tf^5*ti^4 + 332*d3q_i*tf^6*ti^3 - 228*d3q_i*tf^7*ti^2 - 5*d4q_i*tf^2*ti^8 + 35*d4q_i*tf^4*ti^6 - 42*d4q_i*tf^5*ti^5 - 7*d4q_i*tf^6*ti^4 + 28*d4q_i*tf^7*ti^3 - 7*d4q_i*tf^8*ti^2 - 6720*dq_f*t^2*tf^5 + 47040*dq_f*t^3*tf^4 - 109200*dq_f*t^4*tf^3 + 104160*dq_f*t^5*tf^2 - 8400*dq_i*t^2*tf^5 + 53760*dq_i*t^3*tf^4 - 117600*dq_i*t^4*tf^3 + 107520*dq_i*t^5*tf^2 + 8400*dq_f*t^2*ti^5 - 53760*dq_f*t^3*ti^4 + 117600*dq_f*t^4*ti^3 - 107520*dq_f*t^5*ti^2 + 6720*dq_i*t^2*ti^5 - 47040*dq_i*t^3*ti^4 + 109200*dq_i*t^4*ti^3 - 104160*dq_i*t^5*ti^2 + 2100*ddq_f*tf^2*ti^6 - 5040*ddq_f*tf^4*ti^4 + 1680*ddq_f*tf^5*ti^3 + 1260*ddq_f*tf^6*ti^2 - 1260*ddq_i*tf^2*ti^6 - 1680*ddq_i*tf^3*ti^5 + 5040*ddq_i*tf^4*ti^4 - 2100*ddq_i*tf^6*ti^2 + 8400*dq_f*tf^2*ti^5 + 11760*dq_f*tf^3*ti^4 - 13440*dq_f*tf^4*ti^3 - 6720*dq_f*tf^5*ti^2 + 6720*dq_i*tf^2*ti^5 + 13440*dq_i*tf^3*ti^4 - 11760*dq_i*tf^4*ti^3 - 8400*dq_i*tf^5*ti^2 + 15120*q_f*t^2*tf^4 - 100800*q_f*t^3*tf^3 + 226800*q_f*t^4*tf^2 - 15120*q_i*t^2*tf^4 + 100800*q_i*t^3*tf^3 - 226800*q_i*t^4*tf^2 + 15120*q_f*t^2*ti^4 - 100800*q_f*t^3*ti^3 + 226800*q_f*t^4*ti^2 - 15120*q_i*t^2*ti^4 + 100800*q_i*t^3*ti^3 - 226800*q_i*t^4*ti^2 + 15120*q_f*tf^2*ti^4 + 40320*q_f*tf^3*ti^3 + 15120*q_f*tf^4*ti^2 - 15120*q_i*tf^2*ti^4 - 40320*q_i*tf^3*ti^3 - 15120*q_i*tf^4*ti^2 - 3600*d3q_f*t^2*tf^2*ti^5 - 6120*d3q_f*t^2*tf^3*ti^4 + 8580*d3q_f*t^2*tf^4*ti^3 + 180*d3q_f*t^2*tf^5*ti^2 + 12120*d3q_f*t^3*tf^2*ti^4 - 3280*d3q_f*t^3*tf^3*ti^3 - 8880*d3q_f*t^3*tf^4*ti^2 - 9660*d3q_f*t^4*tf^2*ti^3 + 11340*d3q_f*t^4*tf^3*ti^2 - 1008*d3q_f*t^5*tf^2*ti^2 - 350*d4q_f*t^2*tf^2*ti^6 + 630*d4q_f*t^2*tf^4*ti^4 - 420*d4q_f*t^2*tf^5*ti^3 - 70*d4q_f*t^2*tf^6*ti^2 + 700*d4q_f*t^3*tf^2*ti^5 - 840*d4q_f*t^3*tf^3*ti^4 - 140*d4q_f*t^3*tf^4*ti^3 + 560*d4q_f*t^3*tf^5*ti^2 - 245*d4q_f*t^4*tf^2*ti^4 + 980*d4q_f*t^4*tf^3*ti^3 - 595*d4q_f*t^4*tf^4*ti^2 - 392*d4q_f*t^5*tf^2*ti^3 - 112*d4q_f*t^5*tf^3*ti^2 + 252*d4q_f*t^6*tf^2*ti^2 - 180*d3q_i*t^2*tf^2*ti^5 - 8580*d3q_i*t^2*tf^3*ti^4 + 6120*d3q_i*t^2*tf^4*ti^3 + 3600*d3q_i*t^2*tf^5*ti^2 + 8880*d3q_i*t^3*tf^2*ti^4 + 3280*d3q_i*t^3*tf^3*ti^3 - 12120*d3q_i*t^3*tf^4*ti^2 - 11340*d3q_i*t^4*tf^2*ti^3 + 9660*d3q_i*t^4*tf^3*ti^2 + 1008*d3q_i*t^5*tf^2*ti^2 + 70*d4q_i*t^2*tf^2*ti^6 + 420*d4q_i*t^2*tf^3*ti^5 - 630*d4q_i*t^2*tf^4*ti^4 + 350*d4q_i*t^2*tf^6*ti^2 - 560*d4q_i*t^3*tf^2*ti^5 + 140*d4q_i*t^3*tf^3*ti^4 + 840*d4q_i*t^3*tf^4*ti^3 - 700*d4q_i*t^3*tf^5*ti^2 + 595*d4q_i*t^4*tf^2*ti^4 - 980*d4q_i*t^4*tf^3*ti^3 + 245*d4q_i*t^4*tf^4*ti^2 + 112*d4q_i*t^5*tf^2*ti^3 + 392*d4q_i*t^5*tf^3*ti^2 - 252*d4q_i*t^6*tf^2*ti^2 + 1260*ddq_f*t^2*tf^2*ti^4 - 63840*ddq_f*t^2*tf^3*ti^3 + 13860*ddq_f*t^2*tf^4*ti^2 + 62160*ddq_f*t^3*tf^2*ti^3 + 45360*ddq_f*t^3*tf^3*ti^2 - 80640*ddq_f*t^4*tf^2*ti^2 - 13860*ddq_i*t^2*tf^2*ti^4 + 63840*ddq_i*t^2*tf^3*ti^3 - 1260*ddq_i*t^2*tf^4*ti^2 - 45360*ddq_i*t^3*tf^2*ti^3 - 62160*ddq_i*t^3*tf^3*ti^2 + 80640*ddq_i*t^4*tf^2*ti^2 + 144480*dq_f*t^2*tf^2*ti^3 - 157920*dq_f*t^2*tf^3*ti^2 + 13440*dq_f*t^3*tf^2*ti^2 + 157920*dq_i*t^2*tf^2*ti^3 - 144480*dq_i*t^2*tf^3*ti^2 - 13440*dq_i*t^3*tf^2*ti^2 + 544320*q_f*t^2*tf^2*ti^2 - 544320*q_i*t^2*tf^2*ti^2 - 600*d3q_f*t*tf*ti^7 + 240*d3q_f*t*tf^7*ti - 32*d4q_f*t*tf*ti^8 - 10*d4q_f*t*tf^8*ti - 240*d3q_i*t*tf*ti^7 + 600*d3q_i*t*tf^7*ti + 10*d4q_i*t*tf*ti^8 + 32*d4q_i*t*tf^8*ti - 4200*ddq_f*t*tf*ti^6 - 2520*ddq_f*t*tf^6*ti - 15120*ddq_f*t^6*tf*ti + 2520*ddq_i*t*tf*ti^6 + 4200*ddq_i*t*tf^6*ti + 15120*ddq_i*t^6*tf*ti - 16800*dq_f*t*tf*ti^5 + 13440*dq_f*t*tf^5*ti + 3360*dq_f*t^5*tf*ti - 13440*dq_i*t*tf*ti^5 + 16800*dq_i*t*tf^5*ti - 3360*dq_i*t^5*tf*ti - 30240*q_f*t*tf*ti^4 - 30240*q_f*t*tf^4*ti + 604800*q_f*t^4*tf*ti + 30240*q_i*t*tf*ti^4 + 30240*q_i*t*tf^4*ti - 604800*q_i*t^4*tf*ti - 600*d3q_f*t*tf^2*ti^6 + 3600*d3q_f*t*tf^3*ti^5 - 1440*d3q_f*t*tf^4*ti^4 - 2280*d3q_f*t*tf^5*ti^3 + 1080*d3q_f*t*tf^6*ti^2 + 2700*d3q_f*t^2*tf*ti^6 - 1920*d3q_f*t^2*tf^6*ti - 3000*d3q_f*t^3*tf*ti^5 + 3720*d3q_f*t^3*tf^5*ti - 2310*d3q_f*t^4*tf*ti^4 - 210*d3q_f*t^4*tf^4*ti + 5712*d3q_f*t^5*tf*ti^3 - 4368*d3q_f*t^5*tf^3*ti - 2520*d3q_f*t^6*tf*ti^2 + 2520*d3q_f*t^6*tf^2*ti + 28*d4q_f*t*tf^2*ti^7 + 168*d4q_f*t*tf^3*ti^6 - 252*d4q_f*t*tf^4*ti^5 + 140*d4q_f*t*tf^6*ti^3 - 40*d4q_f*t*tf^7*ti^2 + 100*d4q_f*t^2*tf*ti^7 + 80*d4q_f*t^2*tf^7*ti - 140*d4q_f*t^3*tf^6*ti - 350*d4q_f*t^4*tf*ti^5 - 70*d4q_f*t^4*tf^5*ti + 448*d4q_f*t^5*tf*ti^4 + 308*d4q_f*t^5*tf^4*ti - 168*d4q_f*t^6*tf*ti^3 - 168*d4q_f*t^6*tf^3*ti - 1080*d3q_i*t*tf^2*ti^6 + 2280*d3q_i*t*tf^3*ti^5 + 1440*d3q_i*t*tf^4*ti^4 - 3600*d3q_i*t*tf^5*ti^3 + 600*d3q_i*t*tf^6*ti^2 + 1920*d3q_i*t^2*tf*ti^6 - 2700*d3q_i*t^2*tf^6*ti - 3720*d3q_i*t^3*tf*ti^5 + 3000*d3q_i*t^3*tf^5*ti + 210*d3q_i*t^4*tf*ti^4 + 2310*d3q_i*t^4*tf^4*ti + 4368*d3q_i*t^5*tf*ti^3 - 5712*d3q_i*t^5*tf^3*ti - 2520*d3q_i*t^6*tf*ti^2 + 2520*d3q_i*t^6*tf^2*ti + 40*d4q_i*t*tf^2*ti^7 - 140*d4q_i*t*tf^3*ti^6 + 252*d4q_i*t*tf^5*ti^4 - 168*d4q_i*t*tf^6*ti^3 - 28*d4q_i*t*tf^7*ti^2 - 80*d4q_i*t^2*tf*ti^7 - 100*d4q_i*t^2*tf^7*ti + 140*d4q_i*t^3*tf*ti^6 + 70*d4q_i*t^4*tf*ti^5 + 350*d4q_i*t^4*tf^5*ti - 308*d4q_i*t^5*tf*ti^4 - 448*d4q_i*t^5*tf^4*ti + 168*d4q_i*t^6*tf*ti^3 + 168*d4q_i*t^6*tf^3*ti - 12600*ddq_f*t*tf^2*ti^5 + 20160*ddq_f*t*tf^3*ti^4 + 11760*ddq_f*t*tf^4*ti^3 - 12600*ddq_f*t*tf^5*ti^2 + 25200*ddq_f*t^2*tf*ti^5 + 20160*ddq_f*t^2*tf^5*ti - 42840*ddq_f*t^3*tf*ti^4 - 42840*ddq_f*t^3*tf^4*ti + 11760*ddq_f*t^4*tf*ti^3 + 20160*ddq_f*t^4*tf^3*ti + 25200*ddq_f*t^5*tf*ti^2 + 20160*ddq_f*t^5*tf^2*ti + 12600*ddq_i*t*tf^2*ti^5 - 11760*ddq_i*t*tf^3*ti^4 - 20160*ddq_i*t*tf^4*ti^3 + 12600*ddq_i*t*tf^5*ti^2 - 20160*ddq_i*t^2*tf*ti^5 - 25200*ddq_i*t^2*tf^5*ti + 42840*ddq_i*t^3*tf*ti^4 + 42840*ddq_i*t^3*tf^4*ti - 20160*ddq_i*t^4*tf*ti^3 - 11760*ddq_i*t^4*tf^3*ti - 20160*ddq_i*t^5*tf*ti^2 - 25200*ddq_i*t^5*tf^2*ti - 77280*dq_f*t*tf^2*ti^4 + 6720*dq_f*t*tf^3*ti^3 + 73920*dq_f*t*tf^4*ti^2 + 119280*dq_f*t^2*tf*ti^4 - 107520*dq_f*t^2*tf^4*ti - 255360*dq_f*t^3*tf*ti^3 + 248640*dq_f*t^3*tf^3*ti + 184800*dq_f*t^4*tf*ti^2 - 193200*dq_f*t^4*tf^2*ti - 73920*dq_i*t*tf^2*ti^4 - 6720*dq_i*t*tf^3*ti^3 + 77280*dq_i*t*tf^4*ti^2 + 107520*dq_i*t^2*tf*ti^4 - 119280*dq_i*t^2*tf^4*ti - 248640*dq_i*t^3*tf*ti^3 + 255360*dq_i*t^3*tf^3*ti + 193200*dq_i*t^4*tf*ti^2 - 184800*dq_i*t^4*tf^2*ti - 181440*q_f*t*tf^2*ti^3 - 181440*q_f*t*tf^3*ti^2 + 241920*q_f*t^2*tf*ti^3 + 241920*q_f*t^2*tf^3*ti - 604800*q_f*t^3*tf*ti^2 - 604800*q_f*t^3*tf^2*ti + 181440*q_i*t*tf^2*ti^3 + 181440*q_i*t*tf^3*ti^2 - 241920*q_i*t^2*tf*ti^3 - 241920*q_i*t^2*tf^3*ti + 604800*q_i*t^3*tf*ti^2 + 604800*q_i*t^3*tf^2*ti))/(tf - ti)^9;
% d4q_des = (d4q_i*tf^9 - d4q_f*ti^9 + 211680*q_f*t^5 - 211680*q_i*t^5 - 120*d3q_f*t*tf^7 + 5*d4q_f*t*tf^8 - 300*d3q_i*t*tf^7 - 25*d4q_i*t*tf^8 + 300*d3q_f*t*ti^7 + 25*d4q_f*t*ti^8 + 120*d3q_i*t*ti^7 - 5*d4q_i*t*ti^8 + 1260*ddq_f*t*tf^6 - 2100*ddq_i*t*tf^6 + 2100*ddq_f*t*ti^6 - 1260*ddq_i*t*ti^6 - 300*d3q_f*tf*ti^7 + 120*d3q_f*tf^7*ti - 16*d4q_f*tf*ti^8 - 5*d4q_f*tf^8*ti - 120*d3q_i*tf*ti^7 + 300*d3q_i*tf^7*ti + 5*d4q_i*tf*ti^8 + 16*d4q_i*tf^8*ti - 6720*dq_f*t*tf^5 - 105840*dq_f*t^5*tf - 8400*dq_i*t*tf^5 - 105840*dq_i*t^5*tf + 8400*dq_f*t*ti^5 + 105840*dq_f*t^5*ti + 6720*dq_i*t*ti^5 + 105840*dq_i*t^5*ti - 2100*ddq_f*tf*ti^6 - 1260*ddq_f*tf^6*ti + 1260*ddq_i*tf*ti^6 + 2100*ddq_i*tf^6*ti - 8400*dq_f*tf*ti^5 + 6720*dq_f*tf^5*ti - 6720*dq_i*tf*ti^5 + 8400*dq_i*tf^5*ti + 15120*q_f*t*tf^4 - 529200*q_f*t^4*tf - 15120*q_i*t*tf^4 + 529200*q_i*t^4*tf + 15120*q_f*t*ti^4 - 529200*q_f*t^4*ti - 15120*q_i*t*ti^4 + 529200*q_i*t^4*ti - 15120*q_f*tf*ti^4 - 15120*q_f*tf^4*ti + 15120*q_i*tf*ti^4 + 15120*q_i*tf^4*ti + 1380*d3q_f*t^2*tf^6 - 4620*d3q_f*t^3*tf^5 + 5880*d3q_f*t^4*tf^4 - 2520*d3q_f*t^5*tf^3 - 60*d4q_f*t^2*tf^7 + 210*d4q_f*t^3*tf^6 - 280*d4q_f*t^4*tf^5 + 126*d4q_f*t^5*tf^4 + 2400*d3q_i*t^2*tf^6 - 6300*d3q_i*t^3*tf^5 + 6720*d3q_i*t^4*tf^4 - 2520*d3q_i*t^5*tf^3 + 150*d4q_i*t^2*tf^7 - 350*d4q_i*t^3*tf^6 + 350*d4q_i*t^4*tf^5 - 126*d4q_i*t^5*tf^4 - 2400*d3q_f*t^2*ti^6 + 6300*d3q_f*t^3*ti^5 - 6720*d3q_f*t^4*ti^4 + 2520*d3q_f*t^5*ti^3 - 150*d4q_f*t^2*ti^7 + 350*d4q_f*t^3*ti^6 - 350*d4q_f*t^4*ti^5 + 126*d4q_f*t^5*ti^4 - 1380*d3q_i*t^2*ti^6 + 4620*d3q_i*t^3*ti^5 - 5880*d3q_i*t^4*ti^4 + 2520*d3q_i*t^5*ti^3 + 60*d4q_i*t^2*ti^7 - 210*d4q_i*t^3*ti^6 + 280*d4q_i*t^4*ti^5 - 126*d4q_i*t^5*ti^4 - 13860*ddq_f*t^2*tf^5 + 44520*ddq_f*t^3*tf^4 - 54600*ddq_f*t^4*tf^3 + 22680*ddq_f*t^5*tf^2 + 18900*ddq_i*t^2*tf^5 - 52920*ddq_i*t^3*tf^4 + 58800*ddq_i*t^4*tf^3 - 22680*ddq_i*t^5*tf^2 - 18900*ddq_f*t^2*ti^5 + 52920*ddq_f*t^3*ti^4 - 58800*ddq_f*t^4*ti^3 + 22680*ddq_f*t^5*ti^2 + 13860*ddq_i*t^2*ti^5 - 44520*ddq_i*t^3*ti^4 + 54600*ddq_i*t^4*ti^3 - 22680*ddq_i*t^5*ti^2 - 300*d3q_f*tf^2*ti^6 + 1800*d3q_f*tf^3*ti^5 - 720*d3q_f*tf^4*ti^4 - 1140*d3q_f*tf^5*ti^3 + 540*d3q_f*tf^6*ti^2 + 14*d4q_f*tf^2*ti^7 + 84*d4q_f*tf^3*ti^6 - 126*d4q_f*tf^4*ti^5 + 70*d4q_f*tf^6*ti^3 - 20*d4q_f*tf^7*ti^2 - 540*d3q_i*tf^2*ti^6 + 1140*d3q_i*tf^3*ti^5 + 720*d3q_i*tf^4*ti^4 - 1800*d3q_i*tf^5*ti^3 + 300*d3q_i*tf^6*ti^2 + 20*d4q_i*tf^2*ti^7 - 70*d4q_i*tf^3*ti^6 + 126*d4q_i*tf^5*ti^4 - 84*d4q_i*tf^6*ti^3 - 14*d4q_i*tf^7*ti^2 + 70560*dq_f*t^2*tf^4 - 218400*dq_f*t^3*tf^3 + 260400*dq_f*t^4*tf^2 + 80640*dq_i*t^2*tf^4 - 235200*dq_i*t^3*tf^3 + 268800*dq_i*t^4*tf^2 - 80640*dq_f*t^2*ti^4 + 235200*dq_f*t^3*ti^3 - 268800*dq_f*t^4*ti^2 - 70560*dq_i*t^2*ti^4 + 218400*dq_i*t^3*ti^3 - 260400*dq_i*t^4*ti^2 - 6300*ddq_f*tf^2*ti^5 + 10080*ddq_f*tf^3*ti^4 + 5880*ddq_f*tf^4*ti^3 - 6300*ddq_f*tf^5*ti^2 + 6300*ddq_i*tf^2*ti^5 - 5880*ddq_i*tf^3*ti^4 - 10080*ddq_i*tf^4*ti^3 + 6300*ddq_i*tf^5*ti^2 - 38640*dq_f*tf^2*ti^4 + 3360*dq_f*tf^3*ti^3 + 36960*dq_f*tf^4*ti^2 - 36960*dq_i*tf^2*ti^4 - 3360*dq_i*tf^3*ti^3 + 38640*dq_i*tf^4*ti^2 - 151200*q_f*t^2*tf^3 + 453600*q_f*t^3*tf^2 + 151200*q_i*t^2*tf^3 - 453600*q_i*t^3*tf^2 - 151200*q_f*t^2*ti^3 + 453600*q_f*t^3*ti^2 + 151200*q_i*t^2*ti^3 - 453600*q_i*t^3*ti^2 - 90720*q_f*tf^2*ti^3 - 90720*q_f*tf^3*ti^2 + 90720*q_i*tf^2*ti^3 + 90720*q_i*tf^3*ti^2 + 18180*d3q_f*t^2*tf^2*ti^4 - 4920*d3q_f*t^2*tf^3*ti^3 - 13320*d3q_f*t^2*tf^4*ti^2 - 19320*d3q_f*t^3*tf^2*ti^3 + 22680*d3q_f*t^3*tf^3*ti^2 - 2520*d3q_f*t^4*tf^2*ti^2 + 1050*d4q_f*t^2*tf^2*ti^5 - 1260*d4q_f*t^2*tf^3*ti^4 - 210*d4q_f*t^2*tf^4*ti^3 + 840*d4q_f*t^2*tf^5*ti^2 - 490*d4q_f*t^3*tf^2*ti^4 + 1960*d4q_f*t^3*tf^3*ti^3 - 1190*d4q_f*t^3*tf^4*ti^2 - 980*d4q_f*t^4*tf^2*ti^3 - 280*d4q_f*t^4*tf^3*ti^2 + 756*d4q_f*t^5*tf^2*ti^2 + 13320*d3q_i*t^2*tf^2*ti^4 + 4920*d3q_i*t^2*tf^3*ti^3 - 18180*d3q_i*t^2*tf^4*ti^2 - 22680*d3q_i*t^3*tf^2*ti^3 + 19320*d3q_i*t^3*tf^3*ti^2 + 2520*d3q_i*t^4*tf^2*ti^2 - 840*d4q_i*t^2*tf^2*ti^5 + 210*d4q_i*t^2*tf^3*ti^4 + 1260*d4q_i*t^2*tf^4*ti^3 - 1050*d4q_i*t^2*tf^5*ti^2 + 1190*d4q_i*t^3*tf^2*ti^4 - 1960*d4q_i*t^3*tf^3*ti^3 + 490*d4q_i*t^3*tf^4*ti^2 + 280*d4q_i*t^4*tf^2*ti^3 + 980*d4q_i*t^4*tf^3*ti^2 - 756*d4q_i*t^5*tf^2*ti^2 + 93240*ddq_f*t^2*tf^2*ti^3 + 68040*ddq_f*t^2*tf^3*ti^2 - 161280*ddq_f*t^3*tf^2*ti^2 - 68040*ddq_i*t^2*tf^2*ti^3 - 93240*ddq_i*t^2*tf^3*ti^2 + 161280*ddq_i*t^3*tf^2*ti^2 + 20160*dq_f*t^2*tf^2*ti^2 - 20160*dq_i*t^2*tf^2*ti^2 + 2700*d3q_f*t*tf*ti^6 - 1920*d3q_f*t*tf^6*ti + 100*d4q_f*t*tf*ti^7 + 80*d4q_f*t*tf^7*ti + 1920*d3q_i*t*tf*ti^6 - 2700*d3q_i*t*tf^6*ti - 80*d4q_i*t*tf*ti^7 - 100*d4q_i*t*tf^7*ti + 25200*ddq_f*t*tf*ti^5 + 20160*ddq_f*t*tf^5*ti - 45360*ddq_f*t^5*tf*ti - 20160*ddq_i*t*tf*ti^5 - 25200*ddq_i*t*tf^5*ti + 45360*ddq_i*t^5*tf*ti + 119280*dq_f*t*tf*ti^4 - 107520*dq_f*t*tf^4*ti + 8400*dq_f*t^4*tf*ti + 107520*dq_i*t*tf*ti^4 - 119280*dq_i*t*tf^4*ti - 8400*dq_i*t^4*tf*ti + 241920*q_f*t*tf*ti^3 + 241920*q_f*t*tf^3*ti + 1209600*q_f*t^3*tf*ti - 241920*q_i*t*tf*ti^3 - 241920*q_i*t*tf^3*ti - 1209600*q_i*t^3*tf*ti - 3600*d3q_f*t*tf^2*ti^5 - 6120*d3q_f*t*tf^3*ti^4 + 8580*d3q_f*t*tf^4*ti^3 + 180*d3q_f*t*tf^5*ti^2 - 4500*d3q_f*t^2*tf*ti^5 + 5580*d3q_f*t^2*tf^5*ti - 4620*d3q_f*t^3*tf*ti^4 - 420*d3q_f*t^3*tf^4*ti + 14280*d3q_f*t^4*tf*ti^3 - 10920*d3q_f*t^4*tf^3*ti - 7560*d3q_f*t^5*tf*ti^2 + 7560*d3q_f*t^5*tf^2*ti - 350*d4q_f*t*tf^2*ti^6 + 630*d4q_f*t*tf^4*ti^4 - 420*d4q_f*t*tf^5*ti^3 - 70*d4q_f*t*tf^6*ti^2 - 210*d4q_f*t^2*tf^6*ti - 700*d4q_f*t^3*tf*ti^5 - 140*d4q_f*t^3*tf^5*ti + 1120*d4q_f*t^4*tf*ti^4 + 770*d4q_f*t^4*tf^4*ti - 504*d4q_f*t^5*tf*ti^3 - 504*d4q_f*t^5*tf^3*ti - 180*d3q_i*t*tf^2*ti^5 - 8580*d3q_i*t*tf^3*ti^4 + 6120*d3q_i*t*tf^4*ti^3 + 3600*d3q_i*t*tf^5*ti^2 - 5580*d3q_i*t^2*tf*ti^5 + 4500*d3q_i*t^2*tf^5*ti + 420*d3q_i*t^3*tf*ti^4 + 4620*d3q_i*t^3*tf^4*ti + 10920*d3q_i*t^4*tf*ti^3 - 14280*d3q_i*t^4*tf^3*ti - 7560*d3q_i*t^5*tf*ti^2 + 7560*d3q_i*t^5*tf^2*ti + 70*d4q_i*t*tf^2*ti^6 + 420*d4q_i*t*tf^3*ti^5 - 630*d4q_i*t*tf^4*ti^4 + 350*d4q_i*t*tf^6*ti^2 + 210*d4q_i*t^2*tf*ti^6 + 140*d4q_i*t^3*tf*ti^5 + 700*d4q_i*t^3*tf^5*ti - 770*d4q_i*t^4*tf*ti^4 - 1120*d4q_i*t^4*tf^4*ti + 504*d4q_i*t^5*tf*ti^3 + 504*d4q_i*t^5*tf^3*ti + 1260*ddq_f*t*tf^2*ti^4 - 63840*ddq_f*t*tf^3*ti^3 + 13860*ddq_f*t*tf^4*ti^2 - 64260*ddq_f*t^2*tf*ti^4 - 64260*ddq_f*t^2*tf^4*ti + 23520*ddq_f*t^3*tf*ti^3 + 40320*ddq_f*t^3*tf^3*ti + 63000*ddq_f*t^4*tf*ti^2 + 50400*ddq_f*t^4*tf^2*ti - 13860*ddq_i*t*tf^2*ti^4 + 63840*ddq_i*t*tf^3*ti^3 - 1260*ddq_i*t*tf^4*ti^2 + 64260*ddq_i*t^2*tf*ti^4 + 64260*ddq_i*t^2*tf^4*ti - 40320*ddq_i*t^3*tf*ti^3 - 23520*ddq_i*t^3*tf^3*ti - 50400*ddq_i*t^4*tf*ti^2 - 63000*ddq_i*t^4*tf^2*ti + 144480*dq_f*t*tf^2*ti^3 - 157920*dq_f*t*tf^3*ti^2 - 383040*dq_f*t^2*tf*ti^3 + 372960*dq_f*t^2*tf^3*ti + 369600*dq_f*t^3*tf*ti^2 - 386400*dq_f*t^3*tf^2*ti + 157920*dq_i*t*tf^2*ti^3 - 144480*dq_i*t*tf^3*ti^2 - 372960*dq_i*t^2*tf*ti^3 + 383040*dq_i*t^2*tf^3*ti + 386400*dq_i*t^3*tf*ti^2 - 369600*dq_i*t^3*tf^2*ti + 544320*q_f*t*tf^2*ti^2 - 907200*q_f*t^2*tf*ti^2 - 907200*q_f*t^2*tf^2*ti - 544320*q_i*t*tf^2*ti^2 + 907200*q_i*t^2*tf*ti^2 + 907200*q_i*t^2*tf^2*ti)/(tf - ti)^9;
 